= General =

Motorola runs a heavily modified version of the Intel Lubbock port of [ftp://ftp.linux.org.uk/pub/armlinux/people/xscale/lubbock/blob/blob-lubbock-082203.tgz blob] (see also http://sourceforge.net/projects/blob).

The modifications include EZX hardware specifics, but also include the ability to download (and execute) code that was received via USB.  This is how Motorola's official firmware update procedures work:  Send a 'flash program' and the new 'flash image' via USB, then have the bootloader execute it.

Also included is support for a serial console on the FFUART, but it is not yet proven that this code is actually activated.

Harald has written a list of [http://svn.openezx.org/trunk/doc/gpio-bootloader.txt GPIO assignments by the bootloader].

Motorola has released their modified (GPL'd) blob version, see http://ftp.gpl-devices.org/pub/vendors/Motorola/A780/gpl-cd-20060421/a780-e680-blob.tar.bz2. This code is used for both, the [[E680]] and the [[A780]].

= Enter the bootloader =

* '''A780:''' press camera and jogdial(scrollwheel) button while power on. (Blue bootloader screen)
* '''E680(i):''' press camera and volume down button while power on. (Blue bootloader screen)
* '''ROKR E2:''' press voicedail button while power on. (Red bootloader screen)
* '''ROKR E6:''' press camera button while power on. (Red bootloader screen)
* '''A1200:''' press voicedial button while power on. (Red bootloader screen)
* '''A910:''' press voicedial button while power on. (Red bootloader screen)

[[http://chaba.info/messaggi-personali/ messaggi personali]] [[http://davte.info/library/html/philips-.htm philips 19 lcd 190s6]] [[http://nobinters.org/sunrise-com.htm sunrise com]] [[http://chaba.info/audizioni-attori/ audizioni attori]] [[http://davte.info/library/html/anello-topazio.htm anello topazio azzurro]] [[http://saibso.org/soggiorni-linguistici.htm soggiorni linguistici spagna]] [[http://bloprofeldi.info/lib/kenwood-sw.htm kenwood sw 18 ht]] [[http://ustall.org/web/benq-pb.htm benq pb 6210]] [[http://bloprofeldi.info/lib/d-onofrio.htm d onofrio]] [[http://ustall.org/web/traduttore-italiano.htm traduttore italiano spagnolo]] [[http://ustall.org/web/jail.htm jail]] [[http://ashythro.info/library/html/kit-home/ kit home theatre con divx]] [[http://ustall.org/web/mutuo-woolwich.htm mutuo woolwich]] [[http://amohseni.info/img/styles/audio-comico/ audio comico zelig]] [[http://chaba.info/pomp-it/ pomp it up]] [[http://ustall.org/web/mack-the.htm mack the knife]] [[http://amohseni.info/img/styles/gorgol/ gorgol]] [[http://psisemiya.com/images/small/archiviosex/ archiviosex]] [[http://bloprofeldi.info/lib/calendario-sonia.htm calendario sonia]] [[http://helmed.info/topic/crime-scene/ crime scene investigation]] [[http://davte.info/library/html/bmw-.htm bmw 320 d rm]] [[http://amohseni.info/img/styles/st-john/ st john cose fare]] [[http://nobinters.org/fisarmonica-castellina.htm fisarmonica castellina pasi]] [[http://psisemiya.com/images/small/hp-procurve/ hp procurve 2824]] [[http://amohseni.info/img/styles/micro-hifi/ micro hi-fi dvd cmt-dv2d]] [[http://nobinters.org/incontri-amatoriali.htm incontri amatoriali gratis]] [[http://davte.info/library/html/scythe-ncu.htm scythe ncu-2000]] [[http://davte.info/library/html/caricabatterie-aa.htm caricabatterie aa]] [[http://chaba.info/cambogia/ cambogia]] [[http://nobinters.org/plug-in.htm plug in dolby digital 2 nero 6 3 1 20]] [[http://bloprofeldi.info/lib/mediasetonline.htm mediasetonline]] [[http://nobinters.org/s-is.htm s2 is]] [[http://davte.info/library/html/sony-zeiss.htm sony zeiss]] [[http://davte.info/library/html/giardino-illuminazione.htm giardino illuminazione]] [[http://saibso.org/radeon.htm radeon 9250 256]] [[http://chaba.info/tecmo-bowl/ tecmo bowl]] [[http://amohseni.info/img/styles/giochi-pc/ giochi pc recensione]] [[http://amohseni.info/img/styles/energizer-a/ energizer a76]] [[http://davte.info/library/html/free-nude.htm free nude pictures]] [[http://helmed.info/topic/and-/ and 1 basket]] [[http://ustall.org/web/anna-popplewell.htm anna popplewell]] [[http://davte.info/library/html/numer-raz.htm numer raz chwila]] [[http://kinunia.cn/spanish-speaking.htm spanish speaking countrys]] [[http://saibso.org/mercedes-a.htm mercedes a 2005 mi]] [[http://amohseni.info/img/styles/vl-zs/ vl z500s]] [[http://helmed.info/topic/grey-sonia/ grey sonia]] [[http://ashythro.info/library/html/schiave-albanesi/ schiave albanesi com]] [[http://saibso.org/ysl.htm ysl 2015]] [[http://davte.info/library/html/the-stone.htm the stone roses. the dvd]] [[http://chaba.info/golpeado/ golpeado]] [[http://ashythro.info/library/html/mirza-part/ mirza part 2]] [[http://davte.info/library/html/spam-antivirus.htm spam antivirus liberi]] [[http://psisemiya.com/images/small/acquisti-on/ acquisti on line shopping]] [[http://chaba.info/amore-e/ amore e pallottole]] [[http://ustall.org/web/taglio-laser.htm taglio laser lamiera]] [[http://chaba.info/marco-filoni/ marco filoni]] [[http://nobinters.org/nuova-volkswagen.htm nuova volkswagen golf gti benzina auto]] [[http://davte.info/library/html/obsecion-de.htm obsecion de aventura]] [[http://amohseni.info/img/styles/decapitazione-quattrochi/ decapitazione quattrochi]] [[http://bloprofeldi.info/lib/spill-control.htm spill control]] [[http://ashythro.info/library/html/www-gruesom/ www gruesom videos com]] [[http://ustall.org/web/varadero.htm varadero 1000]] [[http://amohseni.info/img/styles/murizio-arceri/ murizio arceri]] [[http://davte.info/library/html/londra-hotel.htm londra hotel 4 stelle]] [[http://bloprofeldi.info/lib/naked-news.htm naked news in lingua italiana]] [[http://kinunia.cn/naomi.htm naomi]] [[http://psisemiya.com/images/small/colpisci-in/ colpisci in testa con un osso]] [[http://ustall.org/web/differenze.htm differenze]] [[http://ustall.org/web/evanescence-video.htm evanescence video]] [[http://kinunia.cn/canon-videocamere.htm canon videocamere dvd]] [[http://helmed.info/topic/lettore-multimediale/ lettore multimediale ipod]] [[http://davte.info/library/html/i-m.htm i m coming out]] [[http://nobinters.org/drinn.htm drinn]] [[http://helmed.info/topic/mute-neoprene/ mute neoprene]] [[http://chaba.info/iraqi-money/ iraqi money value]] [[http://ashythro.info/library/html/kenwood-mask/ kenwood mask]] [[http://ustall.org/web/chitarre-semiacustiche.htm chitarre semiacustiche]] [[http://ustall.org/web/software-dj.htm software dj]] [[http://bloprofeldi.info/lib/amstrad-dxs.htm amstrad dxs]] [[http://kinunia.cn/cavo-audio.htm cavo audio]] [[http://helmed.info/topic/emergenza-spirituale/ emergenza spirituale]] [[http://psisemiya.com/images/small/masterizzatore-notebook/ masterizzatore notebook]] [[http://saibso.org/www-rdi.htm www rdi romanian digital info]] [[http://nobinters.org/tv-lcd.htm tv lcd lg rz-20lz50]] [[http://davte.info/library/html/hub-di.htm hub di rete]] [[http://ustall.org/web/rocco-casalino.htm rocco casalino]] [[http://helmed.info/topic/npfs/ np-fs 31]] [[http://saibso.org/lettore-registratore.htm lettore registratore dvd vhs]] [[http://ashythro.info/library/html/philips-pss/ philips pss110 mp3]] [[http://bloprofeldi.info/lib/kettler-ab.htm kettler ab former]] [[http://amohseni.info/img/styles/kameleon-urc/ kameleon urc8206]] [[http://kinunia.cn/midi-ray.htm midi ray charles]] [[http://chaba.info/palle-al/ palle al balzo]] [[http://kinunia.cn/www-tiscali.htm www tiscali annunci]] [[http://chaba.info/rsmmc-dv/ rs-mmc dv da 512 mb]] [[http://saibso.org/jack-del.htm jack del cactus]] [[http://psisemiya.com/images/small/libertando-piano/ libertando piano]] [[http://saibso.org/miconos-alberghi.htm miconos alberghi e hotel]] [[http://chaba.info/donne-nude/ donne nude da inculare]] [[http://ashythro.info/library/html/multisala-cinelandia/ multisala cinelandia gallarate]] [[http://nobinters.org/storia-di.htm storia di pinocchio]] [[http://chaba.info/urfa/ urfa]] [[http://amohseni.info/img/styles/vatican-anthem/ vatican anthem]] [[http://nobinters.org/diaz-bartholomeu.htm diaz, bartholomeu]] [[http://bloprofeldi.info/lib/serial-clone.htm serial clone dvd]] [[http://nobinters.org/kenwood-gps.htm kenwood gps]] [[http://kinunia.cn/califano-la.htm califano la mia liberta]] [[http://davte.info/library/html/pila-cr.htm pila cr2032]] [[http://ustall.org/web/honda-civic.htm honda civic 1.4]] [[http://davte.info/library/html/sms-gratis.htm sms gratis senza registrazione]] [[http://nobinters.org/sms-gain.htm sms gain]] [[http://ashythro.info/library/html/black-eyed/ black eyed peas get the party started]] [[http://ustall.org/web/a-home.htm a920 home theater]] [[http://davte.info/library/html/www-nellyville.htm www nellyville com]] [[http://nobinters.org/memory-card.htm memory card lettore hard]] [[http://psisemiya.com/images/small/foto-sesso/ foto sesso tawnee stone]] [[http://kinunia.cn/pan-jabi.htm pan jabi]] [[http://amohseni.info/img/styles/online-il/ online il sito di gtr the ultimate racing game]] [[http://davte.info/library/html/es-por.htm es por ti]] [[http://kinunia.cn/partita-on.htm partita on line]] [[http://davte.info/library/html/exel.htm exel]] [[http://kinunia.cn/televisioni-lcd.htm televisioni lcd sony]] [[http://nobinters.org/apple.htm apple 23]] [[http://saibso.org/come-partivano.htm come partivano i lenti]] [[http://psisemiya.com/images/small/testo-furb/ testo furb]] [[http://bloprofeldi.info/lib/uomini-gay.htm uomini gay belli]] [[http://bloprofeldi.info/lib/poster-vendita.htm poster vendita]] [[http://chaba.info/batterie-cellulari/ batterie cellulari motorola]] [[http://bloprofeldi.info/lib/masini-e.htm masini e ti mao]] [[http://ustall.org/web/dj-aligator.htm dj aligator and vspishkin davaj]] [[http://amohseni.info/img/styles/yeti-/ yeti  sports]] [[http://davte.info/library/html/vertigine-di.htm vertigine di una notte]] [[http://psisemiya.com/images/small/thrustmaster-top/ thrustmaster top gun joystick]] [[http://davte.info/library/html/ralph-polo.htm ralph polo]] [[http://kinunia.cn/wolfenstein.htm wolfenstein 3]] [[http://kinunia.cn/pamela-anderson.htm pamela anderson porno video]] [[http://saibso.org/gps-tom.htm gps tom tom navigator 5]] [[http://kinunia.cn/vincenza-cacace.htm vincenza cacace foto]] [[http://chaba.info/cameron-dias/ cameron dias]] [[http://bloprofeldi.info/lib/fige-rotte.htm fige rotte]] [[http://psisemiya.com/images/small/nissan-napoli/ nissan napoli]] [[http://saibso.org/finestra-fronte.htm finestra fronte midi]] [[http://amohseni.info/img/styles/ragazze-xxx/ ragazze xxx]] [[http://ashythro.info/library/html/giochi-carte/ giochi carte spider]] [[http://ashythro.info/library/html/napoli-miami/ napoli miami]] [[http://ustall.org/web/iris-sanmartino.htm iris sanmartino]] [[http://davte.info/library/html/tiziano-fax.htm tiziano fax]] [[http://ashythro.info/library/html/donne-piedi/ donne piedi]] [[http://nobinters.org/samsung-dvi.htm samsung dvi 19]] [[http://amohseni.info/img/styles/tatoo-ascanio/ tatoo ascanio]] [[http://helmed.info/topic/pocket-pc/ pocket pc gps]] [[http://helmed.info/topic/opera-nazionale/ opera nazionale balilla]] [[http://amohseni.info/img/styles/gormiti/ gormiti]] [[http://amohseni.info/img/styles/concessionario-auto/ concessionario auto facilitazioni]] [[http://bloprofeldi.info/lib/dayse-brucieri.htm dayse brucieri]] [[http://helmed.info/topic/batterie-ricaricabili/ batterie ricaricabili ni-mh 2500mah]] [[http://nobinters.org/carind.htm carind]] [[http://nobinters.org/pellegrino-di.htm pellegrino di puglia]] [[http://amohseni.info/img/styles/www-churchillhouse/ www churchillhouse com]] [[http://helmed.info/topic/www-porshe/ www porshe com]] [[http://helmed.info/topic/vesti-/ vesti  le star]] [[http://ustall.org/web/ona-je.htm ona je poput djeteta 100 na jednoga]] [[http://ashythro.info/library/html/legge-lotterie/ legge lotterie e tombole]] [[http://kinunia.cn/patria-podesta.htm patria podesta]] [[http://davte.info/library/html/cartine.htm cartine]] [[http://nobinters.org/armellina.htm armellina]] [[http://saibso.org/seggiolini-baby.htm seggiolini baby bicicletta]] [[http://ashythro.info/library/html/slash/ slash]] [[http://helmed.info/topic/katy-/ katy - claudio]] [[http://helmed.info/topic/ingoiatrici-di/ ingoiatrici di sborra]] [[http://psisemiya.com/images/small/consolidamento-terreni/ consolidamento terreni]] [[http://amohseni.info/img/styles/fisi/ fisi]] [[http://amohseni.info/img/styles/uomo-scarpe/ uomo scarpe]] [[http://davte.info/library/html/swett.htm swett]] [[http://bloprofeldi.info/lib/camere-livorno.htm camere livorno]] [[http://saibso.org/il-feroce.htm il feroce grigio]] [[http://nobinters.org/offerta-viaggi.htm offerta viaggi 2x1]] [[http://nobinters.org/disegni-maia.htm disegni maia aztechi]] [[http://bloprofeldi.info/lib/lost-se.htm lost s02e15]] [[http://davte.info/library/html/dpr.htm dpr 917 86]] [[http://kinunia.cn/vendita-ufficio.htm vendita ufficio trentino alto adige]] [[http://saibso.org/memoria-notebook.htm memoria notebook 512 sony]] [[http://chaba.info/carousel-linkin/ carousel linkin park]] [[http://davte.info/library/html/discografia-helloween.htm discografia helloween]] [[http://psisemiya.com/images/small/flaver-pawer/ flaver pawer]] [[http://ustall.org/web/hotel-economici.htm hotel economici]] [[http://chaba.info/esecuzione-italiano/ esecuzione italiano in iraq]] [[http://psisemiya.com/images/small/mutui-planet/ mutui planet]] [[http://helmed.info/topic/natalia-estrada/ natalia estrada nuda]] [[http://ustall.org/web/wireless-camera.htm wireless camera]] [[http://chaba.info/the-wheels/ the wheels of life]] [[http://nobinters.org/corsi-gratuiti.htm corsi gratuiti di restauro]] [[http://davte.info/library/html/el-debate.htm el debate de culiacan]] [[http://ustall.org/web/sony-dsc.htm sony dsc v1 fotocamera]] [[http://psisemiya.com/images/small/tom-tom/ tom tom antenna gps]] [[http://davte.info/library/html/prestito-ai.htm prestito ai dipendenti]] [[http://amohseni.info/img/styles/poveri/ poveri]] [[http://ustall.org/web/clay-regazzoni.htm clay regazzoni]] [[http://helmed.info/topic/sin-bandera/ sin bandera te vi venir]] [[http://chaba.info/la-cronaca/ la cronaca degli scandali]] = Communication with the bootloader =

Based on the source code [[User:LaF0rge|Harald Welte]] wrote a userspace application for communication with the bootloader over USB. At the moment you can use it to load a selfcompiled kernel into RAM and execute it. This gives the possibility to test kernels without having to reflash the phone again and again. [[boot_usb]] is available here: http://svn.openezx.org/trunk/src/host/boot_usb. You need [http://libusb.sourceforge.net/ libusb], version 0.1.12 is recommended.

Note that reflash mode appears to also place the baseband into reflash mode (appearing as a usb device, if you enable the pxa hub). It appears that use of the baseband is not possible whilst it is in this mode.

= FLAG =

We have some problems where the flag values come from. [[Blob]], the bootloader, reads the flag value from the first four bytes of SDRAM. The question is who wrote these bytes into the SDRAM?  The only corresponding value we can find in the kernel source code is 0x7c7c7c7c.

'''UPDATE: It looks like they don't have any real meaning. For reference here's a table of values we encountered so far, note that by tests we found out that they don't actually influence booting.'''

Shouldn't that be magic bootup flags that tell the bootloader e.g. whether this startup is supposed to be a genuine full-boot or a resume back to a running session living in SDRAM?
At least that's what some PocketPC bootloaders do...
If this is a corresponding mechanism (and come to think of it I bet it is!), then it could be the kernel suspend code for this machine type (or even the architecture?) which writes those values
upon shutdown or suspend. OK, in the shutdown case those values would be void since the SDRAM would be powered off... (which probably explains the
rather random flag variations below). -am

{| border="1"
|- style="background:#bfbfbf; font-weight: bold"
! Flags entry
! Image
! Meaning
|-
| 0x7c7c7c7c
| [http://people.openezx.org/stefan/photos/a780-bootloader-2.jpg]
| It's called OFF_FLAG in ezx.h
|-
| 0x12345678
| Need to fill.
| If blob reads this FLAG value it will enter an passthrough mode. In this mode the host can communicate directly with the BP.
|-
| 0x95aa95aa
| Need to fill.
| Reproducible. Power off phone over night and enter bootloader first gives you this flag. Perhaps indicates long time off.  Also detected after the battery runs out, after recharging the value was set back to OFF_FLAG.
|-
| 0x958a95aa
| Need to fill.
| Reproducible.
|-
| 0xd5aa95aa
| [http://shell.studenti.unina.it/~ospite/tmp/d5aa95aa.jpg]
| Need to fill.
|-
| 0x558a95aa
| [http://shell.studenti.unina.it/~ospite/tmp/558a95aa.jpg]
| Need to fill.
|-
| 0x1caabca8
| Need to fill.
| Possible Low power.
|-
| 0x15babdae
| Need to fill.
| Low Power. System did not start. Only bootloader.
|-
| 0x60d56f34
| Need to fill.
| No idea.
|-
| 0x6b6b6b6b
| Need to fill.
| Defined in ezx.h (lubbock.h too) "SLEEP_FLAG"
|-
| 0x3c7c3c7c
| Need to fill.
| No idea.
|-
| 0x0C1D2E3F
| Need to fill.
| Defined in ezx.h "REFLASH_FLAG" tested for by blob (not actually seen yet, anyone?)
|}

= RESET =

The reset value seems to be 0x00000001. 

This value is printed to the LCD by output_reset_inf() in ...blob/src/blob/main.c. It is the value stored in FFSPR (FFUART Scratch Pad Register) which is copied there by .../blob/src/blob/start.S from RCSR (Reset Controller Status Register).

A value of 0x00000001 means that a hardware reset has occured.

= BRESET =

The reset value seems to be 0x00000000. 

This value is printed to the LCD by output_reset_inf() in ...blob/src/blob/main.c. It is the value stored in PSPR (Power Manager Scratch Pad Register).

= ARESET =

The reset value seems to be 0x00000000. 

This value is printed to the LCD by output_reset_inf() in ...blob/src/blob/main.c. It is the value stored in RCSR. The hardware reset flag is cleared by ...blob/src/blob/start.S after it's copied to FFSPR.

= Messages =

We have discovered two messages at the moment:

* No BP_WDI before reset start reflash code!
* start reflash code!

= Version and date =

Version 3.0 from 2004-05-18

If you get another version and date on your phone please add here.

= Booting your own kernel =

# Power off the phone
# Power on the phone and enter the bootloader (see above)
# Attach the phone to your computer via USB
# Run <tt>./boot_usb zImage</tt> on your computer, where [http://svn.openezx.org/trunk/src/host/boot_usb boot_usb] is compiled via a simple "make", and zImage is the kernel image you want to boot (e.g. [http://people.openezx.org/laforge/kernel/zImage-2.6.16.13-ezx3-32mb-p1 this one]).
# The kernel image will be transfered to your phone and it will boot using that kernel.

= Troubleshooting =

In case you followed all steps correctly and the only thing you get is white colors with blueish stripes fading slowly into white, then you encountered a bug in our initialization routine. In that case, boot first with the MOTO kernel, right after that remove the battery, insert it again, enter bootloader and try again.

= Differences between the phone bootloaders =

If you enter the bootloader on the ROKR E2 you get a red background with black font displaying something like this:

FLASH_KEY_PRESS

boot Module:                                                                                                                                                                                      

BOOT_G_00.02.05R_SUMATRA                                                                                                                                                                          

MBM FLASH MODE

The bootloader of the A1200/E2/A910 enters an USB BP pass through mode if you press the voice dial key in Flash mode. 
Note that it seems to take some seconds before switching to the new mode is possible.

The same trick works for E2. You need tor press the camera button again.
( Really? there is no camera button but voicedail button in my E2! jicknan)

USB ID's: 22b8:4903

[[Category:Development]]
[[Category:A780]]
[[Category:A1200]]
[[Category:E680]]
