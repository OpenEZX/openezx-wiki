= General =

Motorola runs a heavily modified version of the Intel Lubbock port of [ftp://ftp.linux.org.uk/pub/armlinux/people/xscale/lubbock/blob/blob-lubbock-082203.tgz blob] (see also http://sourceforge.net/projects/blob).

The modifications include EZX hardware specifics, but also include the ability to download (and execute) code that was received via USB.  This is how Motorola's official firmware update procedures work:  Send a 'flash program' and the new 'flash image' via USB, then have the bootloader execute it.

Also included is support for a serial console on the FFUART, but it is not yet proven that this code is actually activated.

Harald has written a list of [http://svn.openezx.org/trunk/doc/gpio-bootloader.txt GPIO assignments by the bootloader].

Motorola has released their modified (GPL'd) blob version, see http://ftp.gpl-devices.org/pub/vendors/Motorola/A780/gpl-cd-20060421/a780-e680-blob.tar.bz2. This code is used for both, the [[E680]] and the [[A780]].

= Enter the bootloader =

* '''A780:''' press camera and jogdial(scrollwheel) button while power on. (Blue bootloader screen)
* '''E680(i):''' press camera and volume down button while power on. (Blue bootloader screen)
* '''ROKR E2:''' press voicedail button while power on. (Red bootloader screen)
* '''ROKR E6:''' press camera button while power on. (Red bootloader screen)
* '''A1200:''' press voicedial button while power on. (Red bootloader screen)
* '''A910:''' press voicedial button while power on. (Red bootloader screen)

[[http://madavid.t35.com/html/baseline/ baseline]] [[http://kiboukni.125mb.com/web/route/ route 2005]] [[http://davelovesyou.somee.com/library/html/video-giorgia/ video giorgia palmas]] [[http://lensman.somee.com/html/sterei-mp/ sterei mp3]] [[http://betheresa.t35.com/text/directory/lcgde-sharp/ lc-32gd7e sharp]] [[http://thegoogly.somee.com/view/new/multitap-sony.htm multitap sony]] [[http://trocterli.t35.com/img/styles/cd-musicali/ cd musicali bollani]] [[http://nationavce.somee.com/library/html/io-e/ io e il vento]] [[http://coarmago.freeweb7.com/library/html/david-sellings.htm david sellings]] [[http://luallard.t35.com/html/the-claas/ the claas]] [[http://viemalin.freeweb7.com/resources/articles/fire.htm fire]] [[http://nairoz.somee.com/img/styles/ghiaccioli/ ghiaccioli]] [[http://dabeutle.t35.com/content/view/la-ballata.htm la ballata del soldato]] [[http://itgurney.t35.com/view/new/programma-sky/ programma sky]] [[http://kiboukni.125mb.com/web/benni/ benni]] [[http://dabeutle.t35.com/content/view/dinovo-logitech.htm dinovo logitech media desktop]] [[http://davelovesyou.somee.com/library/html/sdram-ddr/ sdram ddr]] [[http://rihelm.125mb.com/img/styles/mafia-domenico/ mafia domenico modugno]] [[http://betheresa.t35.com/text/directory/www-mariella/ www mariella nava it]] [[http://trocterli.t35.com/img/styles/uomini-picchi/ uomini picchi]] [[http://ouquaite.freeweb7.com/img/styles/anabra/ anabra]] [[http://trocterli.t35.com/img/styles/potassio/ potassio]] [[http://yourorus.somee.com/data/adidas.htm adidas 36]] [[http://ouquaite.freeweb7.com/img/styles/frog-street/ frog street]] [[http://luallard.t35.com/html/giochi-hardsex/ giochi hardsex]] [[http://rihelm.125mb.com/img/styles/rocoo/ rocoo]] [[http://fawarfo.freeweb7.com/topic/nvidia-.htm nvidia 6600 256mb]] [[http://madavid.t35.com/html/a-silvia/ a silvia analisi del testo]] [[http://brrezab.freeweb7.com/img/styles/la-guerra.htm la guerra dei mondi (1952)]] [[http://rimarsh.t35.com/images/small/la-vita.htm la vita e]] [[http://fawarfo.freeweb7.com/topic/jovanotti-for.htm jovanotti for president]] [[http://itgurney.t35.com/view/new/spettacolo-teatrali/ spettacolo teatrali]] [[http://lakitsmi.freeweb7.com/web/flat-/ flat 29 daewoo]] [[http://nationavce.somee.com/library/html/nikkor-af/ nikkor af 70-300]] [[http://davelovesyou.somee.com/library/html/www-webquiz/ www webquiz it]] [[http://fawarfo.freeweb7.com/topic/nouvelle-experience.htm nouvelle experience]] [[http://jedillar.125mb.com/resources/articles/bci-/ bci 16 bk]] [[http://quotes-girl.somee.com/content/view/ray-ban/ ray ban 3149]] [[http://peter-land.somee.com/images/small/acer-compiuter.htm acer compiuter]] [[http://nationavce.somee.com/library/html/laerte/ laerte]] [[http://lamcgie.t35.com/web/mchine-con.htm mchine con noos]] [[http://de-der.somee.com/library/html/dvd-r.htm dvd r costo]] [[http://madavid.t35.com/html/riding-bullet/ riding bullet dvd]] [[http://nationavce.somee.com/library/html/kjhg/ kjhg]] [[http://brrezab.freeweb7.com/img/styles/impasto-delle.htm impasto delle orecchiette]] [[http://lensman.somee.com/html/ritorno-delle/ ritorno delle rondini]] [[http://rimarsh.t35.com/images/small/nautica-da.htm nautica da quei ragazzi]] [[http://dabeutle.t35.com/content/view/hit-my.htm hit my heart mid]] [[http://ouquaite.freeweb7.com/img/styles/gioco-a/ gioco a scopa]] [[http://trocterli.t35.com/img/styles/batterie-nokia/ batterie nokia 6610]] [[http://betheresa.t35.com/text/directory/racconti-di/ racconti di ragazze inculate]] [[http://lakitsmi.freeweb7.com/web/casa-chiusa/ casa chiusa]] [[http://flheddina.t35.com/web/music-downloads/ music downloads]] [[http://de-der.somee.com/library/html/il-piantatore.htm il piantatore di pellame]] [[http://rihelm.125mb.com/img/styles/custodia-sub/ custodia sub sony]] [[http://flheddina.t35.com/web/rochelle/ rochelle]] [[http://ouquaite.freeweb7.com/img/styles/eugenia-volodina/ eugenia volodina]] [[http://am-i-bird.somee.com/img/styles/web-pages.htm web pages]] [[http://dj-deus.somee.com/lib/famosa-volpe.htm famosa volpe azzurra]] [[http://viemalin.freeweb7.com/resources/articles/masterizzatore-dvd.htm masterizzatore dvd lg]] [[http://yourorus.somee.com/data/big-broters.htm big broters]] [[http://thegoogly.somee.com/view/new/lavoro-generico.htm lavoro generico]] [[http://davelovesyou.somee.com/library/html/jessica-simpson/ jessica simpson nuda]] [[http://lensman.somee.com/html/parenti-affini/ parenti affini]] [[http://quotes-girl.somee.com/content/view/convivendo-kar/ convivendo kar]] [[http://flheddina.t35.com/web/le-cinque/ le cinque mogli dello scapolo]] [[http://lakitsmi.freeweb7.com/web/finardi-amore/ finardi amore diverso]] [[http://am-i-bird.somee.com/img/styles/scheda.htm scheda 939]] [[http://rimarsh.t35.com/images/small/televisione-al.htm televisione al jazeera]] [[http://flheddina.t35.com/web/gruppo-continuita/ gruppo continuita trust 400]] [[http://peter-land.somee.com/images/small/altoadige.htm altoadige]] [[http://lamcgie.125mb.com/html/arsenio-lupin.htm arsenio lupin. vol. 01]] [[http://davelovesyou.somee.com/library/html/occhiali-con/ occhiali con lenti polarizzate]] [[http://lakitsmi.freeweb7.com/web/integratore-hoodia/ integratore hoodia]] [[http://am-i-bird.somee.com/img/styles/toner-phaser.htm toner phaser 8500]] [[http://kiboukni.125mb.com/web/sodimm-/ sodimm 256 mb]] [[http://thegoogly.somee.com/view/new/zorba-s.htm zorba s dance]] [[http://peter-land.somee.com/images/small/k-.htm k2 - lultima sfida]] [[http://thegoogly.somee.com/view/new/tipo-de.htm tipo de archivo]] [[http://lamcgie.t35.com/web/outclock.htm outclock]] [[http://coarmago.freeweb7.com/library/html/martino-bruno.htm martino bruno]] [[http://fawarfo.freeweb7.com/topic/scarica-il.htm scarica il gladiatore]] [[http://brrezab.freeweb7.com/img/styles/nuova-golf.htm nuova golf plus diesel auto nuove]] [[http://quotes-girl.somee.com/content/view/avril-my/ avril my world]] [[http://flheddina.t35.com/web/www-volare/ www volare group it]] [[http://rimarsh.t35.com/images/small/bingham-hiram.htm bingham, hiram]] [[http://am-i-bird.somee.com/img/styles/sisal.htm sisal 05 06 04]] [[http://yourorus.somee.com/data/traduzione-vie.htm traduzione vie en rose]] [[http://brrezab.freeweb7.com/img/styles/t-shirt.htm t shirt- dolce e gabbana]] [[http://am-i-bird.somee.com/img/styles/mariateresaruta.htm mariateresaruta]] [[http://betheresa.t35.com/text/directory/che-tettone/ che tettone]] [[http://thegoogly.somee.com/view/new/opel-zafira.htm opel zafira 2000]] [[http://betheresa.t35.com/text/directory/drift/ drift]] [[http://nairoz.somee.com/img/styles/spartito-dragonstea/ spartito dragonstea din tei]] [[http://coarmago.freeweb7.com/library/html/gundam-torna.htm gundam torna in foto e video]] [[http://ouquaite.freeweb7.com/img/styles/preparate-i/ preparate i fazzoletti]] [[http://kiboukni.125mb.com/web/stampanti-samsung/ stampanti samsung scx 4100]] [[http://nairoz.somee.com/img/styles/volante-pc/ volante pc force]] [[http://lakitsmi.freeweb7.com/web/www-pormo/ www pormo com]] [[http://nairoz.somee.com/img/styles/dragon-ninja/ dragon ninja]] [[http://rihelm.125mb.com/img/styles/superdotati-veri/ superdotati veri]] [[http://coarmago.freeweb7.com/library/html/hotel-rivazzurra.htm hotel rivazzurra]] [[http://quotes-girl.somee.com/content/view/energy-system/ energy system]] [[http://coarmago.freeweb7.com/library/html/getbusy.htm getbusy]] [[http://lamcgie.125mb.com/html/kurt.htm kurt]] [[http://flheddina.t35.com/web/need-for/ need for speed 2 ps2]] [[http://de-der.somee.com/library/html/poe-planet.htm poe planet]] [[http://fergus-mac.somee.com/description/lib/ragazza-san/ ragazza san vito capo]] [[http://fawarfo.freeweb7.com/topic/impianti-di.htm impianti di aspirazione]] [[http://betheresa.t35.com/text/directory/garibaldi-innamorato/ garibaldi innamorato]] [[http://nationavce.somee.com/library/html/she-will/ she will be loved maroon5]] [[http://kiboukni.125mb.com/web/www-fideuram/ www fideuram]] [[http://yourorus.somee.com/data/honda-civic.htm honda civic 1997]] [[http://nairoz.somee.com/img/styles/sondaggio-terra/ sondaggio terra lycos]] [[http://de-der.somee.com/library/html/lwena.htm lwena]] [[http://rihelm.125mb.com/img/styles/cher-cd/ cher cd]] [[http://lamcgie.125mb.com/html/infradito.htm infradito 45]] [[http://nairoz.somee.com/img/styles/sex-film/ sex film]] [[http://quotes-girl.somee.com/content/view/www-rainair/ www rainair it]] [[http://quotes-girl.somee.com/content/view/daniel-pearl/ daniel pearl]] [[http://lensman.somee.com/html/due-stelle/ due stelle nella polvere]] [[http://lamcgie.125mb.com/html/e.htm e606]] [[http://flheddina.t35.com/web/gokart/ go-kart]] [[http://jututor.125mb.com/lib/mitsubishi/ mitsubishi]] [[http://thegoogly.somee.com/view/new/fabolous-breathe.htm fabolous breathe]] [[http://viemalin.freeweb7.com/resources/articles/mercedes-c.htm mercedes c180]] [[http://davelovesyou.somee.com/library/html/sito-e/ sito e nuove foto per 100 bullets]] [[http://jututor.125mb.com/lib/haleakala/ haleakala]] [[http://nationavce.somee.com/library/html/okyweb/ okyweb 2]] [[http://thegoogly.somee.com/view/new/notebook.htm notebook 3 4]] [[http://davelovesyou.somee.com/library/html/in-the/ in the air tonight di lenny kravitz]] [[http://jututor.125mb.com/lib/denardi-it/ denardi it]] [[http://viemalin.freeweb7.com/resources/articles/negra.htm negra]] [[http://quotes-girl.somee.com/content/view/il-bandito/ il bandito della california]] [[http://peter-land.somee.com/images/small/gioco-vecchio.htm gioco vecchio]] [[http://itgurney.t35.com/view/new/erotic-story/ erotic story]] [[http://madavid.t35.com/html/blue-testo/ blue testo a chi mi dice]] [[http://lakitsmi.freeweb7.com/web/mezzora-sottozero/ mezzora sottozero]] [[http://rimarsh.t35.com/images/small/vieni-con.htm vieni con me paolo conte]] [[http://viemalin.freeweb7.com/resources/articles/vendita-dominio.htm vendita dominio]] [[http://lamcgie.125mb.com/html/curve-pericolose.htm curve pericolose]] [[http://rimarsh.t35.com/images/small/senza-fili.htm senza fili home theatre panasonic]] [[http://brrezab.freeweb7.com/img/styles/tenda-trio.htm tenda trio]] [[http://rihelm.125mb.com/img/styles/sms-telefonino/ sms telefonino]] [[http://flheddina.t35.com/web/asta-penna/ asta penna]] [[http://jedillar.125mb.com/resources/articles/porno-dive/ porno dive]] [[http://davelovesyou.somee.com/library/html/acer-alms/ acer al1714ms]] [[http://dabeutle.t35.com/content/view/compaq-tc.htm compaq tc1100]] [[http://kiboukni.125mb.com/web/le-due/ le due madonne]] [[http://madavid.t35.com/html/kingston-kvrxc/ kingston kvr400x64c25 512]] [[http://yourorus.somee.com/data/apple-.htm apple - ipod 40]] [[http://lensman.somee.com/html/roma-/ roma 12 palestra]] [[http://fawarfo.freeweb7.com/topic/home-cinema.htm home cinema lg]] [[http://nairoz.somee.com/img/styles/orologio-/ orologio 380 watt]] [[http://jututor.125mb.com/lib/guerre-arabo/ guerre arabo israeliane 1948]] [[http://peter-land.somee.com/images/small/sport-calcio.htm sport calcio]] [[http://am-i-bird.somee.com/img/styles/myra-melford.htm myra melford]] [[http://dabeutle.t35.com/content/view/ricevitore-nokia.htm ricevitore nokia bluetooth gps]] [[http://yourorus.somee.com/data/hard-disk.htm hard disk esterno 80 gb usb 2 0 7 200]] [[http://betheresa.t35.com/text/directory/barmen/ barmen]] [[http://flheddina.t35.com/web/rollerblade-aero/ rollerblade aero]] [[http://ouquaite.freeweb7.com/img/styles/gentiana-ismaili/ gentiana ismaili]] [[http://jututor.125mb.com/lib/kylie-minogue/ kylie minogue i belive in you]] [[http://betheresa.t35.com/text/directory/mitac/ mitac 6120]] [[http://madavid.t35.com/html/forno-microonde/ forno microonde ventilato]] [[http://yourorus.somee.com/data/plextor-hard.htm plextor hard disk esterno 2 5]] [[http://betheresa.t35.com/text/directory/hotel-a/ hotel a ischia]] [[http://trocterli.t35.com/img/styles/screensaver-bambino/ screensaver bambino]] [[http://ouquaite.freeweb7.com/img/styles/lallievo/ lallievo]] [[http://de-der.somee.com/library/html/jane-indy.htm jane indy plus isofix]] [[http://lamcgie.t35.com/web/bobby-pulido.htm bobby pulido fotos]] [[http://davelovesyou.somee.com/library/html/mercedes-sw/ mercedes sw classe e]] [[http://viemalin.freeweb7.com/resources/articles/scommessa-on.htm scommessa on line]] [[http://dabeutle.t35.com/content/view/estratto-di.htm estratto di malto]] [[http://davelovesyou.somee.com/library/html/robert-taylor/ robert taylor]] [[http://coarmago.freeweb7.com/library/html/problema-obesita.htm problema obesita inghilterra]] [[http://coarmago.freeweb7.com/library/html/categoria-protette.htm categoria protette]] [[http://betheresa.t35.com/text/directory/il-canto/ il canto del deserto]] [[http://rihelm.125mb.com/img/styles/tunisino/ tunisino]] [[http://coarmago.freeweb7.com/library/html/investigativi.htm investigativi]] [[http://lamcgie.t35.com/web/winstanley.htm winstanley]] [[http://fergus-mac.somee.com/description/lib/videocamera-jvc/ videocamera jvc mc200]] [[http://yourorus.somee.com/data/sony-nw.htm sony nw e507]] [[http://yourorus.somee.com/data/monitor-tft.htm monitor tft 7]] [[http://fawarfo.freeweb7.com/topic/vergini-vogliose.htm vergini vogliose]] [[http://lamcgie.t35.com/web/groupage.htm groupage]] [[http://rihelm.125mb.com/img/styles/totally-blonde/ totally blonde]] [[http://lamcgie.125mb.com/html/prenotazione-villaggio.htm prenotazione villaggio vacanza]] [[http://trocterli.t35.com/img/styles/oops-martina/ oops martina colombari]] [[http://nationavce.somee.com/library/html/canzone-appassionata/ canzone appassionata]] [[http://ouquaite.freeweb7.com/img/styles/ragazzi-maschi/ ragazzi maschi gf]] [[http://peter-land.somee.com/images/small/san-martino.htm san martino poesia giovanni pascoli]] [[http://dj-deus.somee.com/lib/adattatore-rca.htm adattatore rca]] [[http://lensman.somee.com/html/dragostea-tin/ dragostea tin dea]] [[http://ouquaite.freeweb7.com/img/styles/lettore-smart/ lettore smart card sd usb]] [[http://flheddina.t35.com/web/trudno-tak/ trudno tak]] [[http://coarmago.freeweb7.com/library/html/over-grip.htm over grip]] [[http://kiboukni.125mb.com/web/internet-via/ internet via satellite]] [[http://itgurney.t35.com/view/new/efficienza/ efficienza]] [[http://nairoz.somee.com/img/styles/patrica/ patrica]] = Communication with the bootloader =

Based on the source code [[User:LaF0rge|Harald Welte]] wrote a userspace application for communication with the bootloader over USB. At the moment you can use it to load a selfcompiled kernel into RAM and execute it. This gives the possibility to test kernels without having to reflash the phone again and again. [[boot_usb]] is available here: http://svn.openezx.org/trunk/src/host/boot_usb. You need [http://libusb.sourceforge.net/ libusb], version 0.1.12 is recommended.

Note that reflash mode appears to also place the baseband into reflash mode (appearing as a usb device, if you enable the pxa hub). It appears that use of the baseband is not possible whilst it is in this mode.

= FLAG =

We have some problems where the flag values come from. [[Blob]], the bootloader, reads the flag value from the first four bytes of SDRAM. The question is who wrote these bytes into the SDRAM?  The only corresponding value we can find in the kernel source code is 0x7c7c7c7c.

'''UPDATE: It looks like they don't have any real meaning. For reference here's a table of values we encountered so far, note that by tests we found out that they don't actually influence booting.'''

Shouldn't that be magic bootup flags that tell the bootloader e.g. whether this startup is supposed to be a genuine full-boot or a resume back to a running session living in SDRAM?
At least that's what some PocketPC bootloaders do...
If this is a corresponding mechanism (and come to think of it I bet it is!), then it could be the kernel suspend code for this machine type (or even the architecture?) which writes those values
upon shutdown or suspend. OK, in the shutdown case those values would be void since the SDRAM would be powered off... (which probably explains the
rather random flag variations below). -am

{| border="1"
|- style="background:#bfbfbf; font-weight: bold"
! Flags entry
! Image
! Meaning
|-
| 0x7c7c7c7c
| [http://people.openezx.org/stefan/photos/a780-bootloader-2.jpg]
| It's called OFF_FLAG in ezx.h
|-
| 0x12345678
| Need to fill.
| If blob reads this FLAG value it will enter an passthrough mode. In this mode the host can communicate directly with the BP.
|-
| 0x95aa95aa
| Need to fill.
| Reproducible. Power off phone over night and enter bootloader first gives you this flag. Perhaps indicates long time off.  Also detected after the battery runs out, after recharging the value was set back to OFF_FLAG.
|-
| 0x958a95aa
| Need to fill.
| Reproducible.
|-
| 0xd5aa95aa
| [http://shell.studenti.unina.it/~ospite/tmp/d5aa95aa.jpg]
| Need to fill.
|-
| 0x558a95aa
| [http://shell.studenti.unina.it/~ospite/tmp/558a95aa.jpg]
| Need to fill.
|-
| 0x1caabca8
| Need to fill.
| Possible Low power.
|-
| 0x15babdae
| Need to fill.
| Low Power. System did not start. Only bootloader.
|-
| 0x60d56f34
| Need to fill.
| No idea.
|-
| 0x6b6b6b6b
| Need to fill.
| Defined in ezx.h (lubbock.h too) "SLEEP_FLAG"
|-
| 0x3c7c3c7c
| Need to fill.
| No idea.
|-
| 0x0C1D2E3F
| Need to fill.
| Defined in ezx.h "REFLASH_FLAG" tested for by blob (not actually seen yet, anyone?)
|}

= RESET =

The reset value seems to be 0x00000001. 

This value is printed to the LCD by output_reset_inf() in ...blob/src/blob/main.c. It is the value stored in FFSPR (FFUART Scratch Pad Register) which is copied there by .../blob/src/blob/start.S from RCSR (Reset Controller Status Register).

A value of 0x00000001 means that a hardware reset has occured.

= BRESET =

The reset value seems to be 0x00000000. 

This value is printed to the LCD by output_reset_inf() in ...blob/src/blob/main.c. It is the value stored in PSPR (Power Manager Scratch Pad Register).

= ARESET =

The reset value seems to be 0x00000000. 

This value is printed to the LCD by output_reset_inf() in ...blob/src/blob/main.c. It is the value stored in RCSR. The hardware reset flag is cleared by ...blob/src/blob/start.S after it's copied to FFSPR.

= Messages =

We have discovered two messages at the moment:

* No BP_WDI before reset start reflash code!
* start reflash code!

= Version and date =

Version 3.0 from 2004-05-18

If you get another version and date on your phone please add here.

= Booting your own kernel =

# Power off the phone
# Power on the phone and enter the bootloader (see above)
# Attach the phone to your computer via USB
# Run <tt>./boot_usb zImage</tt> on your computer, where [http://svn.openezx.org/trunk/src/host/boot_usb boot_usb] is compiled via a simple "make", and zImage is the kernel image you want to boot (e.g. [http://people.openezx.org/laforge/kernel/zImage-2.6.16.13-ezx3-32mb-p1 this one]).
# The kernel image will be transfered to your phone and it will boot using that kernel.

= Troubleshooting =

In case you followed all steps correctly and the only thing you get is white colors with blueish stripes fading slowly into white, then you encountered a bug in our initialization routine. In that case, boot first with the MOTO kernel, right after that remove the battery, insert it again, enter bootloader and try again.

= Differences between the phone bootloaders =

If you enter the bootloader on the ROKR E2 you get a red background with black font displaying something like this:

FLASH_KEY_PRESS

boot Module:                                                                                                                                                                                      

BOOT_G_00.02.05R_SUMATRA                                                                                                                                                                          

MBM FLASH MODE

The bootloader of the A1200/E2/A910 enters an USB BP pass through mode if you press the voice dial key in Flash mode. 
Note that it seems to take some seconds before switching to the new mode is possible.

The same trick works for E2. You need tor press the camera button again.
( Really? there is no camera button but voicedail button in my E2! jicknan)

USB ID's: 22b8:4903

[[Category:Development]]
[[Category:A780]]
[[Category:A1200]]
[[Category:E680]]
