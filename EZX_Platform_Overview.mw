[[Category:Hardware]]

Taken from Harald Welte's OpenEZX slide presentation (Dec 2005) available [http://events.ccc.de/congress/2005/fahrplan/attachments/677-FreeSoftwareGSMPhone-Slides.pdf here] as a pdf.

Original Disclaimer: All Information is based on observation (of A780), and may be wrong



==Hardware==

===Family Names===

Bulverde refers to the Intel PXA CPU platform, of which all EZX phone models are currently a subset.

EZX family subset names and their handsets (some help here)

*A780:  [[A780]],[[E680]]
*Barbados:
*Martinique: [[A910]]
*Hainan: [[A1200]]
*Sumatra:  [[Rokr E2]]

===Processors===

*A Motorola Neptune LTE based mobile phone (BP) plus
*A PXA270 Xscale (AP) based PDA in one case


====Application Processor ([http://www.chipdocs.com/datasheets/datasheet-pdf/Intel/PXA270.html PXA270])====

*Runs heavily modified linux-2.4.20 kernel
*48MB RAM
*32MB "wireless" [http://www.intel.com/design/flcomp/datashts/252633.htm StrataFlash]
** contains bootloader, kernel, rootfs, /ezxlocal, /usr/setup and a logo bitmap.
*software-configurable clock speed up to 400MHz
*JTAG port on test pads, BSDL file and JFlash available
*SPI/SSP interface to PCAP and BP
*directly attached to LCD display
*directly attached to touch screen, buttons
*directly attached to camera module

====[[Baseband_Processor|Baseband Processor]] ([http://www.freescale.com/webapp/sps/site/prod_summary.jsp?code=i.250-22&nodeId=01J4Fsm6cyHs6S Neptune LTE Platform])====

*contains ARM7TDMI for GSM stack
*contains 566xx DSP for digital baseband
*JTAG port on test pads, but no BSDL file
*Connected to Application processor via USB
*SPI/SSP interface to PCAP and AP
*UART connected to AGPS processor
*Connects to GSM SIM module
*8MB external flash
*2MB external RAM

====AGPS Processor (Motorola Telematics MG4100)====

*Attached to UART of BP
*Has it's own Flash and RAM (2MB?)


===PCAP2===

*Power management, Clock and Audio Peripheral (PCAP)
*produces a 16 different voltages
*handles all mono/stereo audio
*connected to 2 speakers, microphone, vibrator
*clock generation
*SPI/SSP interface to AP and BP
*Backlight control


===RF Subsystems (A780)===
====RF6003====
*fractional-n RF synthesizer
====RF2722====
*GPRS/EDGE capable receiver (RX)
====RF3144====
*quad-band power amplifier (TX)


===Flash chips ([http://www.m-systems.com/NR/rdonlyres/9D12C607-DE69-4270-B7DF-D869456DD683/0/DiskOnChip_Based_MCP07_Rev10.pdf DiskOnChip based MCP])===
*16MB SDRAM
*64MB DiskOnChip G3
**contains /diska and /usr/language

==Software==

===linux-2.4.20===
*MontaVista "mobilinux" additions
*dynamic power management
*EZX arm subarchitecture
*low-level drivers for:
**SPI/SSP
**PCAP Audio (mono/stereo/headset/...)
**Vibrator (/dev/vibrator)
**USB host port attached to BP
**USB device port (belcarra usbd, not gadget)
**Transflash/SD/MMC
*THREE proprietary flash file systems
**Intel VFM (hatcreek.o)
**m-systems DiskOnChip (tffs.o)
**third unknown
*A1200 and ROKR E2 have custom Selinux static kernel module called [[motoac]]

The modified Linux kernel used on the Motorola Linux phones has been released by Motorola on SourceForge:
* http://sourceforge.net/projects/a760/
* http://sourceforge.net/projects/e680/

Multiple versions are available:
* [http://sourceforge.net/project/showfiles.php?group_id=116309&package_id=126302&release_id=259130 linux_kernel_a760_2.tar.bz2] seems to be based on Linux 2.4.18, and was uploaded to SourceForge on 2004-08-09.
** Judging from ''drivers/misc/ezx-log.c'' it seems to contain code for the [[A760]] only.
* [http://sourceforge.net/project/showfiles.php?group_id=142482&package_id=156813&release_id=339095 original_kernel.tar.gz] seems to be based on Linux 2.4.20, and was uploaded to SourceForge on 2005-07-01.
** Judging from ''drivers/misc/ezx-log.c'' it seems to contain code for the [[A760]], [[E680]], and [[A780]]
* [http://sourceforge.net/project/showfiles.php?group_id=142482&package_id=156813&release_id=383388 original_kernel_2.tar.gz] seems to be based on Linux 2.4.20, and was uploaded to SourceForge on 2006-01-06.
** Judging from ''drivers/misc/ezx-log.c'' it seems to contain code for the [[A760]], [[E680]], and [[A780]].

The Linux Kernel running on (most) EZX smartphones is a 2.4.20 based kernel, with the following modifications:

* Lots of hardware (cpu/architecture) related patches to mips/ppc/arm from MontaVista
* Drivers for
** PXA270 Dynamic Power Management
** PXA270 SD/MMC Controller (depending on firmware version statically linked !!)
** Camera (v4l2 driver)
** Keypad
** Buttons
** PXA270 Framebuffer
** PXA270 Touchscreen
** IPC (AP<->BP) USB Host
** USB Device (Belcarra usbd, _not_ the Linux gadget driver)
* Proprietary kernel modules for
** USB IPC demultiplex ([[mux_cli]])
** GPRS (gprsv)
** Intel VFM (hatcreek) flash file system
*** Generic code is released by Intel upon request, but not GPL-compatible
** MSystems TrueFFS (tffs) flash file system
*** Acts as a translation layer between VFAT and the underlying flash device
*** vfat is only required to achieve USB mass storage compatibility for Windows boxes
** Logging/testing of AP, BP and DSP (logger)


For in depth analysis of the code see [[CodeAnalysis]]

===Modules===

====mux_cli.o====
*hooks into special functions of USB host driver
*provides GSM TS07.10 (de)multiplex
*userspace has tty devices

====gprsv.o====
*implements GPRS line discipline for mux_cli ttys
*hooks into netfilter to intercept DNS packets ?!?
*provides gprs0 / grps1 network devices

[[http://load.rigour.info/view/new/pentax-svi.htm pentax svi]] [[http://pagina.rigour.info/mp/ mp2]] [[http://online.rigour.info/mazda-/ mazda 6 benzina]] [[http://italy.rigour.info/blog/www-blupanorama.htm www blupanorama]] [[http://guest.rigour.info/library/html/giacomo-leopardi/ giacomo leopardi foto]] [[http://all.rigour.info/here-i/ here i come here i go]] [[http://italy.rigour.info/blog/staccionate.htm staccionate]] [[http://web.rigour.info/robiie-williams/ robiie williams]] [[http://online.rigour.info/chrysler-voyager/ chrysler voyager 2.5 crd]] [[http://note.rigour.info/content/view/fuck-ti.htm fuck ti]] [[http://web.rigour.info/back-in/ back in time]] [[http://dir.rigour.info/prescott/ prescott 478]] [[http://dir.rigour.info/ipod-shuffle/ ipod shuffle sport]] [[http://load.rigour.info/view/new/so-damn.htm so damn beautiful]] [[http://milano.rigour.info/lavoro-gallipoli.htm lavoro gallipoli]] [[http://up.rigour.info/description/lib/brig-me.htm brig me to live]] [[http://here.rigour.info/blog/the-waitress.htm the waitress]] [[http://uve.rigour.info/blog/il-sacrificio.htm il sacrificio del sangue]] [[http://uve.rigour.info/blog/lofra-mx.htm lofra mx 66]] [[http://milano.rigour.info/game-boy.htm game boy advance alimentatore]] [[http://pagina.rigour.info/acer-dlp/ acer dlp]] [[http://paga.rigour.info/mensajes-movistar/ mensajes movistar]] [[http://italy.rigour.info/blog/mauro-lavezzi.htm mauro lavezzi]] [[http://load.rigour.info/view/new/gioco-con.htm gioco con la tastiera numerica]] [[http://up.rigour.info/description/lib/annunci-ragazze.htm annunci ragazze cinesi]] [[http://content.rigour.info/html/orologio-festina/ orologio festina]] [[http://italy.rigour.info/blog/catc.htm catc]] [[http://up.rigour.info/description/lib/testi-per.htm testi per pianoforte]] [[http://content.rigour.info/html/canzoni-zecchino/ canzoni zecchino d oro]] [[http://note.rigour.info/content/view/sony-vaio.htm sony vaio t2xp s]] [[http://guest.rigour.info/library/html/wheel-xbox/ wheel xbox mad catz]] [[http://down.rigour.info/blog/dc.htm dc5100 530]] [[http://web.rigour.info/xp/ xp 2600]] [[http://gratis.rigour.info/content/view/super-cazzoni.htm super cazzoni]] [[http://uve.rigour.info/blog/navigatore-per.htm navigatore per palmare hp]] [[http://pagina.rigour.info/tarantelle-pugliesi/ tarantelle pugliesi]] [[http://speed.rigour.info/my-heart.htm my heart go on]] [[http://down.rigour.info/blog/fiore-d.htm fiore d arancio]] [[http://pagina.rigour.info/la-passionaria/ la passionaria]] [[http://gratis.rigour.info/content/view/rotta-per.htm rotta per casa]] [[http://speed.rigour.info/leutschau.htm leutschau]] [[http://all.rigour.info/best-of/ best of santana]] [[http://here.rigour.info/blog/photo-pack.htm photo pack]] [[http://blog.rigour.info/web/max-pane/ max pane]] [[http://speed.rigour.info/partite-on.htm partite on line]] [[http://it.rigour.info/topic/test-medicina/ test medicina]] [[http://load.rigour.info/view/new/tema-immigrazione.htm tema immigrazione]] [[http://up.rigour.info/description/lib/petlust-com.htm petlust com]] [[http://load.rigour.info/view/new/philips-elettrodomestici.htm philips elettrodomestici]] [[http://gratis.rigour.info/content/view/esami-traccia.htm esami traccia prima prova]] [[http://dir.rigour.info/vallata/ vallata]] [[http://italy.rigour.info/blog/file-divertenti.htm file divertenti gratis]] [[http://pagina.rigour.info/pny-geforce/ pny geforce 7800gtx 256 mb pci express]] [[http://blog.rigour.info/web/distributore-coca/ distributore coca]] [[http://milano.rigour.info/fiera-di.htm fiera di san lazzaro]] [[http://blog.rigour.info/web/fax-colori/ fax colori]] [[http://load.rigour.info/view/new/tg-regione.htm tg regione]] [[http://guest.rigour.info/library/html/tatoo-bracciali/ tatoo bracciali tribali]] [[http://blog.rigour.info/web/nick-drake/ nick drake]] [[http://uve.rigour.info/blog/condotto-cpu.htm condotto cpu]] [[http://guest.rigour.info/library/html/video-della/ video della decapitazione ostaggio usa]] [[http://italy.rigour.info/blog/segreteria-don.htm segreteria don carlo gnocchi]] [[http://content.rigour.info/html/pentium-/ pentium 4 3 3 ghz]] [[http://blog.rigour.info/web/behringer-xm/ behringer xm8500]] [[http://speed.rigour.info/straight-to.htm straight to n ont]] [[http://all.rigour.info/pelose-e/ pelose e sexy]] [[http://it.rigour.info/topic/mercedes-slk/ mercedes slk 2001]] [[http://speed.rigour.info/creative-mp.htm creative mp3 20gb]] [[http://paga.rigour.info/de-pinguino/ de pinguino]] [[http://paga.rigour.info/mercedes-clk/ mercedes clk 230 cabrio]] [[http://down.rigour.info/blog/toner-xerox.htm toner xerox phaser 3400]] [[http://load.rigour.info/view/new/lumix-dmc.htm lumix dmc fz2]] [[http://speed.rigour.info/seat.htm seat600]] [[http://pagina.rigour.info/fotoannunci-trans/ fotoannunci trans]] [[http://all.rigour.info/tutti-mi/ tutti mi miei giorni]] [[http://dir.rigour.info/wintv/ wintv 350]] [[http://guest.rigour.info/library/html/ponte-a/ ponte a]] [[http://milano.rigour.info/i-vatussi.htm i vatussi]] [[http://milano.rigour.info/forza-motorsport.htm forza motorsport]] [[http://it.rigour.info/topic/imps-it/ imps it]] [[http://italy.rigour.info/blog/suzuki-burgman.htm suzuki burgman 400]] [[http://load.rigour.info/view/new/mizuno-wave.htm mizuno wave creation vi]] [[http://dir.rigour.info/masterizzatore-dvd/ masterizzatore dvd nec 16x]] [[http://dir.rigour.info/maquillaje-de/ maquillaje de teatro]] [[http://italy.rigour.info/blog/r-y.htm r y]] [[http://online.rigour.info/festivalbar-cult/ festivalbar cult]] [[http://milano.rigour.info/linobanfi.htm linobanfi]] [[http://content.rigour.info/html/rover-streetwise/ rover streetwise]] [[http://blog.rigour.info/web/mapa-de/ mapa de espana]] [[http://note.rigour.info/content/view/letto-singolo.htm letto singolo]] [[http://load.rigour.info/view/new/appignano-del.htm appignano del tronto]] [[http://gratis.rigour.info/content/view/clip-battesimo.htm clip battesimo]] [[http://web.rigour.info/www-ergoitalia/ www ergoitalia it]] [[http://pagina.rigour.info/pianetabari/ pianetabari]] [[http://guest.rigour.info/library/html/taipei-cose/ taipei cose fare]] [[http://dir.rigour.info/workcentre-pe/ workcentre pe16]] [[http://speed.rigour.info/hotel-adelaide.htm hotel adelaide]] [[http://dir.rigour.info/popeye-vol/ popeye. vol. 21]] [[http://pagina.rigour.info/la-ragazza/ la ragazza di amburgo]] [[http://here.rigour.info/blog/disney-pc.htm disney pc]] [[http://gratis.rigour.info/content/view/hp-nc.htm hp nc4200]] [[http://load.rigour.info/view/new/dx.htm dx 3255]] [[http://milano.rigour.info/beautiful-christina.htm beautiful christina aguilera]] [[http://uve.rigour.info/blog/lettore-memory.htm lettore memory card 5in1]] [[http://gratis.rigour.info/content/view/tawhid-wal.htm tawhid wal jihad deny]] [[http://down.rigour.info/blog/bailen.htm bailen]] [[http://load.rigour.info/view/new/gps-streetpilot.htm gps streetpilot iii]] [[http://here.rigour.info/blog/stand-diff.htm stand diff]] [[http://pagina.rigour.info/mdc/ mdc]] [[http://note.rigour.info/content/view/i-pod.htm i pod 60 gb apple]] [[http://uve.rigour.info/blog/cassiane.htm cassiane]] [[http://here.rigour.info/blog/garfild.htm garfild]] [[http://note.rigour.info/content/view/donne-che.htm donne che danno il loro cellulare]] [[http://here.rigour.info/blog/dowson-s.htm dowson s creek]] [[http://note.rigour.info/content/view/dragos-te.htm dragos te a dintei]] [[http://pagina.rigour.info/lavatrici-sesto/ lavatrici sesto senso]] [[http://up.rigour.info/description/lib/celentano-mina.htm celentano mina]] [[http://paga.rigour.info/coen-joel/ coen, joel]] [[http://it.rigour.info/topic/kenwood-micro/ kenwood micro hi-fi]] [[http://note.rigour.info/content/view/benelli-letizia.htm benelli letizia]] [[http://dir.rigour.info/giubbotti/ giubbotti]] [[http://web.rigour.info/doppio-cordless/ doppio cordless]] [[http://italy.rigour.info/blog/kellos.htm kellos]] [[http://up.rigour.info/description/lib/usb-pci.htm usb pci]] [[http://up.rigour.info/description/lib/diddo.htm diddo]] [[http://blog.rigour.info/web/tim-curry/ tim curry]] [[http://all.rigour.info/www-sumai/ www sumai it]] [[http://italy.rigour.info/blog/one-shot.htm one shot 80 titoli]] [[http://blog.rigour.info/web/come-fare/ come fare lamore con un negro senza stancarsi]] [[http://web.rigour.info/struggle-of/ struggle of pleasure]] [[http://gratis.rigour.info/content/view/bananarama.htm bananarama]] [[http://here.rigour.info/blog/spoiler.htm spoiler]] [[http://up.rigour.info/description/lib/pau-oristano.htm pau (oristano)]] [[http://content.rigour.info/html/olidata-box/ olidata box esterno usb con hard disk]] [[http://gratis.rigour.info/content/view/philips-casse.htm philips casse mms460]] [[http://note.rigour.info/content/view/vendere-alimenti.htm vendere alimenti]] [[http://guest.rigour.info/library/html/armadillo-/ armadillo  king  5]] [[http://speed.rigour.info/marce-militari.htm marce militari italiane]] [[http://content.rigour.info/html/dvd-recorder/ dvd recorder 5 1]] [[http://milano.rigour.info/pasta-macchina.htm pasta macchina ravioli]] [[http://load.rigour.info/view/new/fiere-elettronica.htm fiere elettronica]] [[http://uve.rigour.info/blog/athlon-.htm athlon 64 pc 3700]] [[http://pagina.rigour.info/cavo-s/ cavo s video tv-out]] [[http://content.rigour.info/html/ufficio-treviglio/ ufficio treviglio]] [[http://pagina.rigour.info/bottiglie-olio/ bottiglie olio]] [[http://note.rigour.info/content/view/narodne.htm narodne]] [[http://content.rigour.info/html/foto-arcuri/ foto arcuri]] [[http://up.rigour.info/description/lib/pagine-bianche.htm pagine bianche belluno]] [[http://gratis.rigour.info/content/view/norberto-bobbio.htm norberto bobbio]] [[http://content.rigour.info/html/primi-denunciati/ primi denunciati]] [[http://dir.rigour.info/www-cupa/ www cupa it]] [[http://online.rigour.info/che-si/ che si giochi in due]] [[http://up.rigour.info/description/lib/nike-triax.htm nike triax]] [[http://down.rigour.info/blog/kyocera-bps.htm kyocera bp-780s]] [[http://down.rigour.info/blog/mort.htm mort]] [[http://gratis.rigour.info/content/view/occhiali-dolce.htm occhiali dolce gabbana uomo]] [[http://italy.rigour.info/blog/un-angelo.htm un angelo non e video]] [[http://speed.rigour.info/dimensioni-lavastoviglia.htm dimensioni lavastoviglia]] [[http://paga.rigour.info/seggiolino-per/ seggiolino per auto chicco]] [[http://guest.rigour.info/library/html/dlink-wireless/ d-link wireless adsl print]] [[http://down.rigour.info/blog/rasoio-elettrico.htm rasoio elettrico braun]] [[http://note.rigour.info/content/view/heidelberg.htm heidelberg]] [[http://down.rigour.info/blog/cdj.htm cdj 800]] [[http://content.rigour.info/html/tv-color/ tv color lcd 30]] [[http://it.rigour.info/topic/maxtor-atlas/ maxtor atlas 80 pin]] [[http://all.rigour.info/lussino/ lussino]] [[http://pagina.rigour.info/posti-di/ posti di lavoro per i disabili]] [[http://note.rigour.info/content/view/proietti.htm proietti]] [[http://up.rigour.info/description/lib/gamepad-xbox.htm gamepad xbox]] [[http://here.rigour.info/blog/www-notmail.htm www notmail com]] [[http://uve.rigour.info/blog/naziona-cantanti.htm naziona cantanti]] [[http://uve.rigour.info/blog/you-can.htm you can]] [[http://here.rigour.info/blog/incontro-lourdes.htm incontro lourdes]] [[http://web.rigour.info/cdv/ cdv]] [[http://italy.rigour.info/blog/fumo-sigaretta.htm fumo sigaretta tumore polmone]] [[http://down.rigour.info/blog/km-mercedes.htm km0 mercedes c 200 diesel auto km 0]] [[http://paga.rigour.info/sigle-sailor/ sigle sailor moon]] [[http://here.rigour.info/blog/tomtom-nokia.htm tomtom nokia serie 60]] [[http://content.rigour.info/html/onionbooty-com/ onionbooty com]] [[http://dir.rigour.info/evita-exe/ evita exe discoteca]] [[http://down.rigour.info/blog/o-surdato.htm o surdato nnammurato]] [[http://all.rigour.info/gestione-centrali/ gestione centrali cogenerazione]] [[http://up.rigour.info/description/lib/exell.htm exell]] [[http://paga.rigour.info/jvc-kd/ jvc kd - avx1]] [[http://uve.rigour.info/blog/calcionapoli.htm calcionapoli]] [[http://web.rigour.info/scarpe-da/ scarpe da running]] [[http://online.rigour.info/vigorsol/ vigorsol]] [[http://italy.rigour.info/blog/matrox-parhelia.htm matrox parhelia pci]] [[http://content.rigour.info/html/decorazione-vetro/ decorazione vetro sabbiatura]] [[http://guest.rigour.info/library/html/java-virtual/ java virtual machine download]] [[http://web.rigour.info/doppia-trappola/ doppia trappola]] [[http://here.rigour.info/blog/ufficio-buccinasco.htm ufficio buccinasco]] [[http://uve.rigour.info/blog/ludacris-stand.htm ludacris stand up]] [[http://milano.rigour.info/thermaltake-liquid.htm thermaltake liquid]] [[http://it.rigour.info/topic/consumado/ consumado]] [[http://down.rigour.info/blog/www-dy.htm www dy it]] [[http://web.rigour.info/schede-video/ schede video gigabyte]] [[http://load.rigour.info/view/new/televisori-.htm televisori 42 al plasma]] [[http://up.rigour.info/description/lib/delta-airlines.htm delta airlines]] [[http://load.rigour.info/view/new/ipoh.htm ipoh]] ====ipsec.o====
*proprietary ipsec stack (don't we already have two GPL licensed?)
*Copyright Certicom Corp

===Libraries===
*glibc

====Bluetooth====
*proprietary userspace program directly opens HCI

====GPS====
*no NMEA, no serial device emulation :(
*proprietary library via mux_cli kernel module

====UI====
*embeddedQt
*Motorola EZX toolkit
*Low-level devices (framebufffer, etc) accessable.

=== Partitions ===

{|
| CodeGroup
| size
| description
|-
| CG0
| 200B
| BP
|-
| CG1
| 2.4M
| BP
|-
| CG2
| 448k
|
|-
| CG3
| 27k
|
|-
| CG18
| 2k
| BP
|-
| CG32
| 856k
| mtd1 linux kernel
|-
| CG33
| 24M
| cramfs root
|-
| CG34
| 5.5M
| mtd2 vfm fs /ezxlocal
|-
| CG35
| 11M
| tffsa cramfs /usr/language
|-
| CG36
| 32k
| cramfs master .cfg files
|-
| CG37
| 128k
| mtd3 "logo" partition. gzipped 16 bit 240x320 windows bmp
|-
| CG38
| 19M
| ttfsb (ttfsb1) vfat /diska
|-
| CG39
| 196B
|
|-
| RDL0
| 128k
| ram downloader?
|-
| RDL3
| 241k
| ram downloader?
|}

<pre>
# cat /proc/mtd 
dev:    size   erasesize  name
mtd0: 00020000 00008000 "Bootloader"
mtd1: 000e0000 00020000 "Kernel"
mtd2: 00580000 00020000 "VFM_Filesystem"
mtd3: 00020000 00020000 "Logo"
</pre>

===Bootloader===
*EZX bootloader
*based on GPL licensed blob
*low-level initialization code (GPIO config, clock, ...)
*vendor specific USB device allows for:
**transfer of executable code from USB host
**execution of transferred executable
*serial console code is present in binary (but not used)
*PST/RSD firmware updates work by uploading a "ramloader"


==="Enhanced Mini USB" (EMU)===

====Port Modes====
*Depending on pullup/pulldown/... resistors
*USB device port
*Serial port (RS232 at 3.3V levels)
*Stereo audio signal
*500mA charger
*Carkit (easy install, professionally installed)
*Factory test

====USB Configurations====
*Official configs
**cdc_acm (serial modem emulation for host pc)
**USB mass storage (transflash and VFAT-on-TFFS devices)
*Undocumented configs
**usbnet "network-BLAN"
***Network device over USB
***Allows telnet into phone
**PST
***Mode used by PST Windows App
**DSPlog
***Apparently a way to dump data from DSP
**NetMonitor
***supposedly for GSM network monitor
**cfg11 (ROKR E2)
***??
