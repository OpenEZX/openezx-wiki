[[Category:Hardware]]

Taken from Harald Welte's OpenEZX slide presentation (Dec 2005) available [http://events.ccc.de/congress/2005/fahrplan/attachments/677-FreeSoftwareGSMPhone-Slides.pdf here] as a pdf.

Original Disclaimer: All Information is based on observation (of A780), and may be wrong



==Hardware==

===Family Names===

Bulverde refers to the Intel PXA CPU platform, of which all EZX phone models are currently a subset.

EZX family subset names and their handsets (some help here)

*A780:  [[A780]],[[E680]]
*Barbados:
*Martinique: [[A910]]
*Hainan: [[A1200]]
*Sumatra:  [[Rokr E2]]

===Processors===

*A Motorola Neptune LTE based mobile phone (BP) plus
*A PXA270 Xscale (AP) based PDA in one case


====Application Processor ([http://www.chipdocs.com/datasheets/datasheet-pdf/Intel/PXA270.html PXA270])====

*Runs heavily modified linux-2.4.20 kernel
*48MB RAM
*32MB "wireless" [http://www.intel.com/design/flcomp/datashts/252633.htm StrataFlash]
** contains bootloader, kernel, rootfs, /ezxlocal, /usr/setup and a logo bitmap.
*software-configurable clock speed up to 400MHz
*JTAG port on test pads, BSDL file and JFlash available
*SPI/SSP interface to PCAP and BP
*directly attached to LCD display
*directly attached to touch screen, buttons
*directly attached to camera module

====[[Baseband_Processor|Baseband Processor]] ([http://www.freescale.com/webapp/sps/site/prod_summary.jsp?code=i.250-22&nodeId=01J4Fsm6cyHs6S Neptune LTE Platform])====

*contains ARM7TDMI for GSM stack
*contains 566xx DSP for digital baseband
*JTAG port on test pads, but no BSDL file
*Connected to Application processor via USB
*SPI/SSP interface to PCAP and AP
*UART connected to AGPS processor
*Connects to GSM SIM module
*8MB external flash
*2MB external RAM

====AGPS Processor (Motorola Telematics MG4100)====

*Attached to UART of BP
*Has it's own Flash and RAM (2MB?)


===PCAP2===

*Power management, Clock and Audio Peripheral (PCAP)
*produces a 16 different voltages
*handles all mono/stereo audio
*connected to 2 speakers, microphone, vibrator
*clock generation
*SPI/SSP interface to AP and BP
*Backlight control


===RF Subsystems (A780)===
====RF6003====
*fractional-n RF synthesizer
====RF2722====
*GPRS/EDGE capable receiver (RX)
====RF3144====
*quad-band power amplifier (TX)


===Flash chips ([http://www.m-systems.com/NR/rdonlyres/9D12C607-DE69-4270-B7DF-D869456DD683/0/DiskOnChip_Based_MCP07_Rev10.pdf DiskOnChip based MCP])===
*16MB SDRAM
*64MB DiskOnChip G3
**contains /diska and /usr/language

==Software==

===linux-2.4.20===
*MontaVista "mobilinux" additions
*dynamic power management
*EZX arm subarchitecture
*low-level drivers for:
**SPI/SSP
**PCAP Audio (mono/stereo/headset/...)
**Vibrator (/dev/vibrator)
**USB host port attached to BP
**USB device port (belcarra usbd, not gadget)
**Transflash/SD/MMC
*THREE proprietary flash file systems
**Intel VFM (hatcreek.o)
**m-systems DiskOnChip (tffs.o)
**third unknown
*A1200 and ROKR E2 have custom Selinux static kernel module called [[motoac]]

The modified Linux kernel used on the Motorola Linux phones has been released by Motorola on SourceForge:
* http://sourceforge.net/projects/a760/
* http://sourceforge.net/projects/e680/

Multiple versions are available:
* [http://sourceforge.net/project/showfiles.php?group_id=116309&package_id=126302&release_id=259130 linux_kernel_a760_2.tar.bz2] seems to be based on Linux 2.4.18, and was uploaded to SourceForge on 2004-08-09.
** Judging from ''drivers/misc/ezx-log.c'' it seems to contain code for the [[A760]] only.
* [http://sourceforge.net/project/showfiles.php?group_id=142482&package_id=156813&release_id=339095 original_kernel.tar.gz] seems to be based on Linux 2.4.20, and was uploaded to SourceForge on 2005-07-01.
** Judging from ''drivers/misc/ezx-log.c'' it seems to contain code for the [[A760]], [[E680]], and [[A780]]
* [http://sourceforge.net/project/showfiles.php?group_id=142482&package_id=156813&release_id=383388 original_kernel_2.tar.gz] seems to be based on Linux 2.4.20, and was uploaded to SourceForge on 2006-01-06.
** Judging from ''drivers/misc/ezx-log.c'' it seems to contain code for the [[A760]], [[E680]], and [[A780]].

The Linux Kernel running on (most) EZX smartphones is a 2.4.20 based kernel, with the following modifications:

* Lots of hardware (cpu/architecture) related patches to mips/ppc/arm from MontaVista
* Drivers for
** PXA270 Dynamic Power Management
** PXA270 SD/MMC Controller (depending on firmware version statically linked !!)
** Camera (v4l2 driver)
** Keypad
** Buttons
** PXA270 Framebuffer
** PXA270 Touchscreen
** IPC (AP<->BP) USB Host
** USB Device (Belcarra usbd, _not_ the Linux gadget driver)
* Proprietary kernel modules for
** USB IPC demultiplex ([[mux_cli]])
** GPRS (gprsv)
** Intel VFM (hatcreek) flash file system
*** Generic code is released by Intel upon request, but not GPL-compatible
** MSystems TrueFFS (tffs) flash file system
*** Acts as a translation layer between VFAT and the underlying flash device
*** vfat is only required to achieve USB mass storage compatibility for Windows boxes
** Logging/testing of AP, BP and DSP (logger)


For in depth analysis of the code see [[CodeAnalysis]]

===Modules===

====mux_cli.o====
*hooks into special functions of USB host driver
*provides GSM TS07.10 (de)multiplex
*userspace has tty devices

====gprsv.o====
*implements GPRS line discipline for mux_cli ttys
*hooks into netfilter to intercept DNS packets ?!?
*provides gprs0 / grps1 network devices

[[http://nobinters.org/www-aida.htm www aida it]] [[http://ustall.org/web/albergo-forli.htm albergo forli]] [[http://saibso.org/modem-adsl.htm modem adsl usb 2 0]] [[http://ashythro.info/library/html/dragonmoon/ dragonmoon]] [[http://kinunia.cn/www-regionesicilia.htm www regionesicilia it]] [[http://ustall.org/web/carrozzine-gemelli.htm carrozzine gemelli]] [[http://bloprofeldi.info/lib/hotel-gerona.htm hotel gerona]] [[http://amohseni.info/img/styles/navigatore-gps/ navigatore gps portatile da auto]] [[http://ustall.org/web/tour-cantanti.htm tour cantanti italiani]] [[http://bloprofeldi.info/lib/krisma-cd.htm krisma cd musicali]] [[http://helmed.info/topic/sogni-doro/ sogni doro]] [[http://helmed.info/topic/midi-magnificat/ midi magnificat]] [[http://ustall.org/web/gravidanza-diete.htm gravidanza diete]] [[http://saibso.org/borgorosso-football.htm borgorosso football club]] [[http://kinunia.cn/capodanno-a.htm capodanno a parigi]] [[http://helmed.info/topic/hp-h/ hp h5550]] [[http://ashythro.info/library/html/la-regina/ la regina dei vichinghi]] [[http://nobinters.org/elettrostimolatori-muscolari.htm elettrostimolatori muscolari]] [[http://davte.info/library/html/i-storm.htm i storm modem atlantis land]] [[http://kinunia.cn/daphnia.htm daphnia]] [[http://nobinters.org/e-cellulari.htm e-630 cellulari samsung]] [[http://helmed.info/topic/tt-/ tt 2005. tourist trophy 2005. isola di man]] [[http://bloprofeldi.info/lib/nokia-.htm nokia 6630 auricolare]] [[http://psisemiya.com/images/small/bartok-il/ bartok il magnifico]] [[http://chaba.info/ambur/ ambur]] [[http://nobinters.org/ibanez-ts.htm ibanez ts9]] [[http://psisemiya.com/images/small/sid-seca/ sid seca2]] [[http://bloprofeldi.info/lib/creare-collana.htm creare collana]] [[http://ustall.org/web/resita.htm resita]] [[http://saibso.org/vendita-accumulatori.htm vendita accumulatori]] [[http://psisemiya.com/images/small/ricoh-/ ricoh 1015 modulo]] [[http://nobinters.org/atlantic-varese.htm atlantic varese]] [[http://amohseni.info/img/styles/something-beautiful/ something beautiful di robbie williams]] [[http://amohseni.info/img/styles/sesso-in/ sesso in puglia]] [[http://psisemiya.com/images/small/schede-video/ schede video nvidia 6800 agp]] [[http://ashythro.info/library/html/x-ball/ x ball]] [[http://davte.info/library/html/monitor-portatile.htm monitor portatile]] [[http://saibso.org/odissea-le.htm odissea le avventure di ulisse]] [[http://psisemiya.com/images/small/i-am/ i am see eih]] [[http://chaba.info/samedov/ samedov]] [[http://davte.info/library/html/siemens-sl.htm siemens sl100 white]] [[http://amohseni.info/img/styles/canberra-shopping/ canberra shopping]] [[http://bloprofeldi.info/lib/sea-glider.htm sea glider]] [[http://chaba.info/timok/ timok]] [[http://bloprofeldi.info/lib/splendida-giornata.htm splendida giornata]] [[http://nobinters.org/indaco-dagli.htm indaco dagli occhi dal cielo zucchero]] [[http://amohseni.info/img/styles/aeroplani-militari/ aeroplani militari]] [[http://nobinters.org/genziana.htm genziana]] [[http://kinunia.cn/voli-aerei.htm voli aerei prenotazione]] [[http://ashythro.info/library/html/sailormoonx/ sailormoonx]] [[http://ashythro.info/library/html/i-sette/ i sette cazzi]] [[http://davte.info/library/html/hambantota.htm hambantota]] [[http://ustall.org/web/league.htm league]] [[http://ustall.org/web/gta-libertycitystories.htm gta libertycitystories]] [[http://saibso.org/valeria-manzi.htm valeria manzi]] [[http://saibso.org/vano.htm vano]] [[http://amohseni.info/img/styles/dolcezze-damore/ dolcezze damore]] [[http://davte.info/library/html/banco-di.htm banco di sicilia]] [[http://davte.info/library/html/archiviazione-elettronica.htm archiviazione elettronica documento]] [[http://nobinters.org/sette-per.htm sette per uno]] [[http://helmed.info/topic/ortopedici/ ortopedici]] [[http://nobinters.org/annunci-con.htm annunci con foto e telefono]] [[http://chaba.info/giacca-estiva/ giacca estiva]] [[http://bloprofeldi.info/lib/djm.htm djm 600]] [[http://psisemiya.com/images/small/ivana-spagna/ ivana spagna e penso a te]] [[http://amohseni.info/img/styles/www-j/ www j lo com]] [[http://bloprofeldi.info/lib/my-immportal.htm my immportal]] [[http://nobinters.org/living.htm living 20]] [[http://saibso.org/hotel-a.htm hotel a jesolo]] [[http://kinunia.cn/festivalbar-cult.htm festivalbar cult]] [[http://davte.info/library/html/black-e.htm black e decker cycl]] [[http://kinunia.cn/zyxel-prestige.htm zyxel prestige 660hw router adsl]] [[http://psisemiya.com/images/small/karkonosze/ karkonosze]] [[http://davte.info/library/html/mario-monti.htm mario monti]] [[http://saibso.org/www-taglia.htm www taglia42 it]] [[http://bloprofeldi.info/lib/cancelleria-del.htm cancelleria del tribunale di bologna]] [[http://chaba.info/la-televicion/ la televicion]] [[http://davte.info/library/html/convertibili.htm convertibili]] [[http://bloprofeldi.info/lib/km-rover.htm km0 rover discovery auto km 0]] [[http://saibso.org/x-in.htm x2 in pillole]] [[http://psisemiya.com/images/small/kyocera-yashica/ kyocera yashica s4]] [[http://psisemiya.com/images/small/hotel-lloret/ hotel lloret de mar]] [[http://kinunia.cn/home-theater.htm home theater terrestre digitale]] [[http://saibso.org/seagate.htm seagate]] [[http://nobinters.org/la-bomba.htm la bomba atomica]] [[http://helmed.info/topic/fumo-tanta/ fumo tanta erba testo]] [[http://bloprofeldi.info/lib/daewoo-dv.htm daewoo dv 115]] [[http://amohseni.info/img/styles/pb-oro/ pb oro srl]] [[http://bloprofeldi.info/lib/hub-.htm hub 8 porte 10 100 1000]] [[http://chaba.info/biglietto-augurio/ biglietto augurio fai te]] [[http://saibso.org/music-maker.htm music maker studio]] [[http://ustall.org/web/dirty-kuffar.htm dirty kuffar video]] [[http://kinunia.cn/sei-ore.htm sei ore di permesso]] [[http://ashythro.info/library/html/captiva-mp/ captiva mp3]] [[http://nobinters.org/www-somma.htm www somma it]] [[http://nobinters.org/la-barca.htm la barca d oro libri]] [[http://saibso.org/non-cambiare.htm non cambiare tu antonacci]] [[http://amohseni.info/img/styles/into-yhe/ into yhe storm]] [[http://psisemiya.com/images/small/renaro/ renaro]] [[http://saibso.org/olivadi.htm olivadi]] [[http://bloprofeldi.info/lib/prosport.htm prosport]] [[http://helmed.info/topic/capello-ricci/ capello ricci]] [[http://davte.info/library/html/scaldabiberon-casa.htm scaldabiberon casa auto]] [[http://amohseni.info/img/styles/mappe-concettuali/ mappe concettuali per geometri]] [[http://ustall.org/web/rapti.htm rapti]] [[http://amohseni.info/img/styles/www-unieuro/ www unieuro com]] [[http://saibso.org/creative-zen.htm creative zen micro 5 gb]] [[http://davte.info/library/html/organo-bontempi.htm organo bontempi]] [[http://nobinters.org/mature-boobs.htm mature boobs]] [[http://saibso.org/labbra-sognanti.htm labbra sognanti]] [[http://bloprofeldi.info/lib/nf-sli.htm nf4 sli diamond]] [[http://saibso.org/kate-moss.htm kate moss the white stripes]] [[http://nobinters.org/regton.htm regton]] [[http://nobinters.org/riders-rohan.htm riders rohan]] [[http://davte.info/library/html/ggggggggggggggggggggggggggggggggg.htm ggggggggggggggggggggggggggggggggg]] [[http://bloprofeldi.info/lib/le-sorelle.htm le sorelle mcleod]] [[http://bloprofeldi.info/lib/e-la.htm e la mia vita albano]] [[http://nobinters.org/giochi-di.htm giochi di movimento]] [[http://ashythro.info/library/html/cosmic/ cosmic]] [[http://psisemiya.com/images/small/camping-it/ camping it]] [[http://ashythro.info/library/html/chi-tocca/ chi tocca il giallo muore]] [[http://kinunia.cn/lacie-hard.htm lacie hard drive 250 gb usb 2 0]] [[http://ashythro.info/library/html/kit-pioneer/ kit pioneer]] [[http://amohseni.info/img/styles/primitivo-di/ primitivo di salento]] [[http://davte.info/library/html/router-switch.htm router switch adsl]] [[http://helmed.info/topic/screensaver-moto/ screensaver moto gp]] [[http://nobinters.org/marmitte-produzione.htm marmitte produzione]] [[http://kinunia.cn/guadagno-dell.htm guadagno dell agente immobiliare]] [[http://helmed.info/topic/ospedali-emilia/ ospedali emilia romagna]] [[http://ustall.org/web/xiamen.htm xiamen]] [[http://nobinters.org/soldi-con.htm soldi con internet]] [[http://helmed.info/topic/popmail/ popmail]] [[http://nobinters.org/www-angela.htm www angela grande fratello3 it]] [[http://nobinters.org/da-sole.htm da sole occhiali da]] [[http://saibso.org/delonghi-forno.htm delonghi forno elettrico]] [[http://kinunia.cn/janet-barboza.htm janet barboza]] [[http://davte.info/library/html/orari-scuola.htm orari scuola materna pubblica bologna]] [[http://kinunia.cn/napolincanto.htm napolincanto]] [[http://bloprofeldi.info/lib/orchestra-serv.htm orchestra serv]] [[http://helmed.info/topic/indus/ indus]] [[http://chaba.info/telecomandi-visa/ telecomandi visa]] [[http://kinunia.cn/informadove.htm informadove]] [[http://kinunia.cn/stampanti-c.htm stampanti c86]] [[http://kinunia.cn/mitac-mio.htm mitac mio 168 destinator 3]] [[http://saibso.org/whirlpool-maxy.htm whirlpool maxy 100]] [[http://saibso.org/marching-season.htm marching season]] [[http://amohseni.info/img/styles/singoli/ singoli 2004]] [[http://bloprofeldi.info/lib/o-zone.htm o zone dragostea din tei dj aligator vs]] [[http://davte.info/library/html/televisori-plasma.htm televisori plasma hd hdmi]] [[http://bloprofeldi.info/lib/bologna-varsavia.htm bologna varsavia]] [[http://saibso.org/cofanetto-star.htm cofanetto star trek]] [[http://nobinters.org/vinovo.htm vinovo]] [[http://nobinters.org/libero-mappa.htm libero mappa]] [[http://saibso.org/ufficio-caccia.htm ufficio caccia vi]] [[http://amohseni.info/img/styles/foo/ foo]] [[http://nobinters.org/gaf-tv.htm gaf tv]] [[http://psisemiya.com/images/small/souvenir-ditalie/ souvenir ditalie]] [[http://bloprofeldi.info/lib/radio-karaoke.htm radio karaoke gratis midi e basi music]] [[http://ustall.org/web/equador.htm equador]] [[http://bloprofeldi.info/lib/www-cesere.htm www cesere ragazzi it]] [[http://bloprofeldi.info/lib/paris-latin.htm paris latin]] [[http://amohseni.info/img/styles/maglie-stretch/ maglie stretch]] [[http://bloprofeldi.info/lib/fiat-panda.htm fiat panda 2001]] [[http://saibso.org/decrypter.htm decrypter]] [[http://psisemiya.com/images/small/nokia-telefonino/ nokia telefonino 6630]] [[http://psisemiya.com/images/small/transvestite/ transvestite]] [[http://kinunia.cn/ufficio-catasto.htm ufficio catasto viterbo]] [[http://nobinters.org/gesso.htm gesso]] [[http://ashythro.info/library/html/tv-lcd/ tv lcd portatile]] [[http://ustall.org/web/asus-kvx.htm asus k8vx 754]] [[http://nobinters.org/ferrari-.htm ferrari 3400 acer portatili]] [[http://kinunia.cn/midi-frisina.htm midi frisina]] [[http://kinunia.cn/nh-amsterdam.htm nh amsterdam centre hotel]] [[http://ashythro.info/library/html/indesit-wixxl/ indesit wixxl 106]] [[http://ashythro.info/library/html/parrucchieri-bergamo/ parrucchieri bergamo]] [[http://saibso.org/sonietta.htm sonietta]] [[http://bloprofeldi.info/lib/canon-powershot.htm canon powershot a52]] [[http://amohseni.info/img/styles/roccavaldina/ roccavaldina]] [[http://nobinters.org/sugar-daddy.htm sugar daddy]] [[http://chaba.info/hotel-on/ hotel on line]] [[http://chaba.info/sara-amo/ sara amo]] [[http://psisemiya.com/images/small/epson/ epson 660]] [[http://helmed.info/topic/sblocco-necv/ sblocco nec616v]] [[http://amohseni.info/img/styles/dj-natasha/ dj natasha]] [[http://psisemiya.com/images/small/le-r/ le 23r51 samsung]] [[http://davte.info/library/html/pony-shetland.htm pony shetland]] [[http://chaba.info/porsce/ porsce]] [[http://kinunia.cn/cesenatico-comune.htm cesenatico comune]] [[http://psisemiya.com/images/small/televisori-/ televisori 20 pollici]] [[http://davte.info/library/html/ancora-ritardi.htm ancora ritardi per kill bill]] [[http://bloprofeldi.info/lib/tomtom-gps.htm tomtom gps]] [[http://kinunia.cn/donne-quarantenne.htm donne quarantenne pompinare]] [[http://nobinters.org/the-corruptor.htm the corruptor indagine a chinatown]] [[http://saibso.org/canon-ehl.htm canon eh18-l]] [[http://kinunia.cn/roselyn-sanchez.htm roselyn sanchez]] [[http://davte.info/library/html/brazilian-ass.htm brazilian ass]] [[http://chaba.info/copertura-linea/ copertura linea adsl]] [[http://kinunia.cn/svaroski.htm svaroski]] [[http://davte.info/library/html/hinh-sex.htm hinh sex ca si hong nhung]] [[http://nobinters.org/black-eyed.htm black eyed shut up]] ====ipsec.o====
*proprietary ipsec stack (don't we already have two GPL licensed?)
*Copyright Certicom Corp

===Libraries===
*glibc

====Bluetooth====
*proprietary userspace program directly opens HCI

====GPS====
*no NMEA, no serial device emulation :(
*proprietary library via mux_cli kernel module

====UI====
*embeddedQt
*Motorola EZX toolkit
*Low-level devices (framebufffer, etc) accessable.

=== Partitions ===

{|
| CodeGroup
| size
| description
|-
| CG0
| 200B
| BP
|-
| CG1
| 2.4M
| BP
|-
| CG2
| 448k
|
|-
| CG3
| 27k
|
|-
| CG18
| 2k
| BP
|-
| CG32
| 856k
| mtd1 linux kernel
|-
| CG33
| 24M
| cramfs root
|-
| CG34
| 5.5M
| mtd2 vfm fs /ezxlocal
|-
| CG35
| 11M
| tffsa cramfs /usr/language
|-
| CG36
| 32k
| cramfs master .cfg files
|-
| CG37
| 128k
| mtd3 "logo" partition. gzipped 16 bit 240x320 windows bmp
|-
| CG38
| 19M
| ttfsb (ttfsb1) vfat /diska
|-
| CG39
| 196B
|
|-
| RDL0
| 128k
| ram downloader?
|-
| RDL3
| 241k
| ram downloader?
|}

<pre>
# cat /proc/mtd 
dev:    size   erasesize  name
mtd0: 00020000 00008000 "Bootloader"
mtd1: 000e0000 00020000 "Kernel"
mtd2: 00580000 00020000 "VFM_Filesystem"
mtd3: 00020000 00020000 "Logo"
</pre>

===Bootloader===
*EZX bootloader
*based on GPL licensed blob
*low-level initialization code (GPIO config, clock, ...)
*vendor specific USB device allows for:
**transfer of executable code from USB host
**execution of transferred executable
*serial console code is present in binary (but not used)
*PST/RSD firmware updates work by uploading a "ramloader"


==="Enhanced Mini USB" (EMU)===

====Port Modes====
*Depending on pullup/pulldown/... resistors
*USB device port
*Serial port (RS232 at 3.3V levels)
*Stereo audio signal
*500mA charger
*Carkit (easy install, professionally installed)
*Factory test

====USB Configurations====
*Official configs
**cdc_acm (serial modem emulation for host pc)
**USB mass storage (transflash and VFAT-on-TFFS devices)
*Undocumented configs
**usbnet "network-BLAN"
***Network device over USB
***Allows telnet into phone
**PST
***Mode used by PST Windows App
**DSPlog
***Apparently a way to dump data from DSP
**NetMonitor
***supposedly for GSM network monitor
**cfg11 (ROKR E2)
***??
