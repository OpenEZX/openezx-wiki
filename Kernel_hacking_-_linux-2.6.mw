Please notice that the development is still in an early state. You should know what you are doing, if you test this.

We are using [http://repo.or.cz/w/topgit.git topgit] to manage our patches ina git tree. Please make sure you have it installed before starting development.

== Building OpenEZX kernel ==
* Get the kernel sources:
 git clone git://git.openezx.org/openezx.git

* Make the repo topgit aware:
 tg remote --populate origin

* Checkout our development branch:
 git checkout ezx/current

* Use the ezx_defconfig for the first build:
 cp arch/arm/configs/ezx_defconfig .config
 make ARCH=arm oldconfig

* Make sure you have a proper toolchain installed. We have pre-built ones for [x86] and [x86_64]
 sudo tar xzf toolchain
 
* Build the kernel:
 make ARCH=arm CROSS_COMPILE=/usr/local/angstrom/arm/bin/arm-angstrom-linux-gnueabi- zImage

* Update your tree later:
 git checkout master && git pull && tg remote --populate origin && git checkout ezx/current && tg update

== Building OpenEZX kernel with openembedded ==
* Please note that OE uses a '''different .config''', and a patchset which '''does not necessarily ressemble the Official OpenEZX patchset''', Kernels built by OE are supported by OE people, at #oe on freenode or openembedded-devel@lists.openembedded.org. Please, dont ask OpenEZX developers (particularly WyrM) '''anything''' if you built your kernel with OE.

* Setup OE according to http://www.openembedded.org/wiki/GettingStarted
 * Note: BitBake 1.6.8 or higher is required. FC6 RPM of BitBake is currently version 1.6.6, so it will not work.
   Recommended way is running it without install.
 * Use <tt>MACHINE=a780</tt> and <tt>DISTRO=angstrom-2007.1</tt> in local.conf

* Run <tt>$ bitbake virtual/kernel</tt>

=== Notes ===
* The last command will fail if you have "." in your PATH
* the kernel expects the rootfs on the '''second''' partition of external flash (<tt>root=/dev/mmcblk0p2</tt>), with this setup you can use the first partition to store some data and access it when booting the original software (recently also kernels built by OE started to follow this convention).
* by default this '''second''' partition must be ext2 fs.
* The STUART console is disabled by default to speed up the booting process. If you want to re-enable it, you have to apply ''ezx-enable-stuart.patch'', and add <tt>console=ttyS2,115200n8</tt> to your <tt>CONFIG_CMDLINE</tt>.

You can use the zImage together with [[Bootloader#Communication_with_the_bootloader|boot_usb]] to boot the phone with this kernel.

[[Category:Development]]
