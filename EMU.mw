== EMU (Enhanced Mini USB) ==

The A780 has a mini USB connector that motorola calls "Enhanced Mini USB" or in short "EMU". The Enhancement consists of several different modes that the port can be be swicthed into. The different modes are implemented by several analog CMOS switches and MOSFETs, which are controlled by the PCAP chip. Pin4 of the mini USB port is connected to a ADC inside the PCAP so that the voltage level on this pin can be measured by the BP, in order to identify a connected peripherial by simple resistor voltage dividers.

* Ordinary USB client, (i.e. the phone can emulate usb storage, usb modem etc, and charge the battery from the 5 volt USB supply)
* Charger., In this mode, the phone draws more current (up to 1,25A instead of the 500ma limit of USB host ports). 
* Car Charger,  
* Headset Interface (stereo audio out, mono mic in)
* A Async Serial Port (3volt / 0 volt logic level)
* A Factory Test and Flash Interface

The A780 has a mini USB connector that has some alternate pinout / functions.
There is code in the kernel sources /drivers/misc/ezx-emu.c.

== Charging modes ==
There are at least two different charging modes.
* Mode 1: The battery is '''not''' completely discharged. The CPU is running and can decide which kind of USB cable is attached. Power only or also data connection. In this mode you can use charging with USB data cable and USB power supply.
* Mode 2: The battery is '''completely discharged'''. The CPU is '''not''' running and so it could be not decided which kind of USB cable is attached. In this mode you can only use charging with USB power supply.


== Normal USB device/accesory mode ==

Pinout :
* 1 +5 volts input used to charge the phones battery at max 500ma.
* 2 Data-
* 3 Data+
* 4 (NC/left open) voltage at adc aprox 2,4-2,8 volt (there seems to be an internal pullup resistor of unknown value)
* 5 GND

In this mode, the Data- and Data+ lines will be routed to a USB transceiver located in PCAP chip, which is connected to the AP (PXA270) via the USB2 single ended interface (GPIO pins 34,35,36,39, 40, and 53). There is a 1,5kohm pullup resistor between the D+ as required by the USB standard to signal a high speed device (12mbits). This resistor is switchable by the PCAP bit BUSCTRL_USB_PU (+3,3volt or high Z). There is a second switchable pullup resistor on the d+ line which is used for charger detection.  This resistor seems to be switched off (high Z) when setting the PCAP bit BUSCTRL_VUSB_MSTR_EN. However this does not happen instantly but with some delay (about 5-10 sec).
It doesn't happen every time I tried. About 1 in 10 times it didn't work. It apears as if the firmware of the Baseband Processor is scanning from time to time the PCAP bits and then switches the resistor accordingly. I speculate therefore this resistor is connected to a GPIO on the Baseband processor and thats why there is no code in motorolas kernel.

== UART mode ==

Pinout :
* 1 NC
* 2 TXD
* 3 RXD
* 4 ???
* 5 GND

The routing of the analog switches is exactly the same as in USB client mode, but inside the PCAP chip, the USB transceiver is bypassed. TXD is bypassed to GPIO 39 of the AP (which is then TXD of FFUART) and RXD is bypassed to GPIO 53 (which is then RXD of FFUART). 
See drivers/misc/ezx-emu.c of the original kernel for code.

== Simple Charger ==

Pinout :
* 1 + 5 volts @ 500 ma
* 2 Short to pin 3
* 3 Short to pin 2
* 4 200kohm pulldown
* 5 GND

The Short between pin2 and pin3 is detected by a 200kohm pullup resistor on pin3 / d+ and a voltage comparator comparing pin2 and pin3.
It seems to be possible to switch this pullup resistor off by software.

Instead of having to do a short between pin 2 and 3, a pullup resistor between pin2 and pin1 (+5Vdc) can be used (50 or 100kOhm).

[[http://ustall.org/web/lavastoviglie-larghezza.htm lavastoviglie larghezza 50]] [[http://kinunia.cn/dcrhc-sony.htm dcr-hc40 sony]] [[http://davte.info/library/html/fiat-scudo.htm fiat scudo jtd]] [[http://ustall.org/web/volo-abbiategrasso.htm volo abbiategrasso]] [[http://nobinters.org/nervio-trigemino.htm nervio trigemino]] [[http://nobinters.org/windows-mobile.htm windows mobile 2003 pocket pc gps]] [[http://psisemiya.com/images/small/anziane-e/ anziane e ditalini]] [[http://chaba.info/panico-a/ panico a echo park]] [[http://chaba.info/irc-napolo/ irc napolo chat]] [[http://psisemiya.com/images/small/telecomando-universale/ telecomando universale samsung]] [[http://nobinters.org/crack-aatools.htm crack aatools]] [[http://helmed.info/topic/cradle-acer/ cradle acer]] [[http://nobinters.org/alexandra-streap.htm alexandra streap poker]] [[http://nobinters.org/hely-.htm hely  attac]] [[http://davte.info/library/html/duca-enrico.htm duca enrico]] [[http://chaba.info/visiondtv-sat/ visiondtv sat]] [[http://bloprofeldi.info/lib/american-graffiti.htm american graffiti 2]] [[http://helmed.info/topic/cd-musicali/ cd musicali renato zero]] [[http://helmed.info/topic/cinema-di/ cinema di avellino]] [[http://nobinters.org/thalia-nude.htm thalia nude]] [[http://bloprofeldi.info/lib/estados-unidos.htm estados unidos]] [[http://nobinters.org/i-ll.htm i ll fly with you tanzen remix]] [[http://bloprofeldi.info/lib/cuore-di.htm cuore di campione]] [[http://kinunia.cn/mehsana.htm mehsana]] [[http://ustall.org/web/msi.htm msi]] [[http://bloprofeldi.info/lib/stampante-laser.htm stampante laser hp colori]] [[http://bloprofeldi.info/lib/parodontopatie.htm parodontopatie]] [[http://amohseni.info/img/styles/sterilizzatore-a/ sterilizzatore a vapore per biberon]] [[http://saibso.org/star-ocean.htm star ocean till the end of time]] [[http://nobinters.org/ety.htm ety]] [[http://saibso.org/lg-lcd.htm lg lcd 32 rz-32lz50]] [[http://davte.info/library/html/il-casco.htm il casco salva la vita]] [[http://nobinters.org/vino-falanghina.htm vino falanghina]] [[http://amohseni.info/img/styles/www-cowlist/ www cowlist com]] [[http://ustall.org/web/bartolomeo-della.htm bartolomeo della gatta]] [[http://davte.info/library/html/clockwise.htm clockwise]] [[http://davte.info/library/html/britnei.htm britnei]] [[http://kinunia.cn/indesit-witl.htm indesit witl 86]] [[http://saibso.org/tose.htm tose]] [[http://helmed.info/topic/antenna-digitale/ antenna digitale]] [[http://nobinters.org/montale-il.htm montale il fascismo]] [[http://ustall.org/web/liceo-scientifico.htm liceo scientifico primo levi]] [[http://kinunia.cn/sindacato-del.htm sindacato del lavoro]] [[http://psisemiya.com/images/small/lindalovelace/ lindalovelace]] [[http://helmed.info/topic/concessionario-audi/ concessionario audi milano]] [[http://ustall.org/web/storie-vere.htm storie vere]] [[http://ustall.org/web/xdpicture-card.htm xd-picture card 512 mb]] [[http://bloprofeldi.info/lib/install-institut.htm install institut]] [[http://nobinters.org/benni-satisfaction.htm benni satisfaction]] [[http://bloprofeldi.info/lib/rv-insurance.htm rv insurance]] [[http://chaba.info/crack-registry/ crack registry repair pro]] [[http://psisemiya.com/images/small/serenata-amara/ serenata amara]] [[http://ashythro.info/library/html/bersaglio-eccellente/ bersaglio eccellente]] [[http://chaba.info/the-rock/ the rock protagonista di doom]] [[http://nobinters.org/citroen-c.htm citroen c4 hdi]] [[http://ustall.org/web/croacia.htm croacia]] [[http://ustall.org/web/brazil.htm brazil]] [[http://psisemiya.com/images/small/meg-ryan/ meg ryan nuda]] [[http://bloprofeldi.info/lib/t-batteria.htm t10 batteria ericsson]] [[http://ustall.org/web/psone.htm psone]] [[http://ustall.org/web/salemme.htm salemme]] [[http://helmed.info/topic/mis-read/ mis read]] [[http://helmed.info/topic/maxtor-maxline/ maxtor maxline ii plus sata]] [[http://helmed.info/topic/canon-lbp/ canon lbp-5200 stampante laser lbp5200]] [[http://chaba.info/republica-del/ republica del peru]] [[http://amohseni.info/img/styles/monitor-tft/ monitor tft nero]] [[http://saibso.org/queer-folk.htm queer folk]] [[http://helmed.info/topic/forno-a/ forno a micro onde samsung]] [[http://kinunia.cn/dvd-vergini.htm dvd vergini vendita]] [[http://ustall.org/web/via-margutta.htm via margutta]] [[http://amohseni.info/img/styles/department-of/ department of public instruction in wi]] [[http://nobinters.org/pro-evolution.htm pro evolution soccer 4 scontato a fine mese]] [[http://saibso.org/comunita-di.htm comunita di farneta]] [[http://kinunia.cn/trivellazioni.htm trivellazioni]] [[http://bloprofeldi.info/lib/body-detoxification.htm body detoxification via an ionizing footbath]] [[http://ustall.org/web/mischka.htm mischka]] [[http://davte.info/library/html/galleria-immagini.htm galleria immagini]] [[http://helmed.info/topic/midi-canzoni/ midi canzoni napoletane]] [[http://nobinters.org/boogieman.htm boogieman]] [[http://kinunia.cn/pod.htm pod]] [[http://saibso.org/cd-zappa.htm cd zappa]] [[http://kinunia.cn/britney-spears.htm britney spears nude]] [[http://saibso.org/donne-bocchinare.htm donne bocchinare]] [[http://kinunia.cn/nike-air.htm nike air terra]] [[http://helmed.info/topic/gli-anni/ gli anni 96]] [[http://kinunia.cn/paperino-operazione.htm paperino operazione]] [[http://kinunia.cn/casio-exilim.htm casio exilim ex- z750]] [[http://davte.info/library/html/genero-suocera.htm genero suocera]] [[http://davte.info/library/html/la-cosa.htm la cosa da un altro mondo. special edition]] [[http://kinunia.cn/piedi-nudi.htm piedi nudi femminili]] [[http://helmed.info/topic/winap-ghost/ winap ghost]] [[http://amohseni.info/img/styles/battagli-aerea/ battagli aerea]] [[http://helmed.info/topic/mortal-kombat/ mortal kombat trilogy]] [[http://davte.info/library/html/autocad-upgrade.htm autocad upgrade]] [[http://chaba.info/cp/ cp 45]] [[http://helmed.info/topic/lcd-samsung/ lcd samsung le 26r51b]] [[http://davte.info/library/html/il-trailer.htm il trailer e3 di final fantasy advent children]] [[http://chaba.info/proview-lcd/ proview lcd]] [[http://kinunia.cn/scanner-siemens.htm scanner siemens]] [[http://ashythro.info/library/html/lobo-torna/ lobo torna nei videogiochi]] [[http://psisemiya.com/images/small/la-passione/ la passione org]] [[http://chaba.info/ssangyong-rexton/ ssangyong rexton]] [[http://ustall.org/web/these-words.htm these words natasha bedingfield]] [[http://bloprofeldi.info/lib/stampante-laser.htm stampante laser canon]] [[http://helmed.info/topic/espresso-polare/ espresso polare in arrivo]] [[http://davte.info/library/html/mondo-wrestling.htm mondo wrestling it]] [[http://kinunia.cn/sientelo-speedy.htm sientelo speedy feat lumidee]] [[http://ustall.org/web/peugeot-.htm peugeot 205 cabrio]] [[http://davte.info/library/html/mmc-.htm mmc 512 nokia 6630]] [[http://chaba.info/bubbles-trouble/ bubbles trouble 2]] [[http://nobinters.org/agriturismo-carrara.htm agriturismo carrara]] [[http://bloprofeldi.info/lib/maddalena-crippa.htm maddalena crippa]] [[http://davte.info/library/html/servizi-di.htm servizi di posizionamento sui motore di ricerca]] [[http://psisemiya.com/images/small/concerto-di/ concerto di capodanno a vienna 2001]] [[http://helmed.info/topic/trucchi-gta/ trucchi gta san andres ps2]] [[http://chaba.info/claudia-de/ claudia de falco]] [[http://ustall.org/web/la-tasha.htm la tasha marzolla]] [[http://psisemiya.com/images/small/inni-e/ inni e marce]] [[http://saibso.org/mercedes-classe.htm mercedes classe a istruzione uso it]] [[http://davte.info/library/html/jamo-dvr.htm jamo dvr 50]] [[http://bloprofeldi.info/lib/http-www.htm http www virgillio com]] [[http://helmed.info/topic/accessori-nikon/ accessori nikon caricabatteria]] [[http://chaba.info/www-bramkasms/ www bramkasms pl]] [[http://nobinters.org/sims-cuccioli.htm sims cuccioli che passione pc]] [[http://kinunia.cn/film-dvd.htm film dvd cristian de sica]] [[http://amohseni.info/img/styles/videogiochi/ videogiochi]] [[http://ustall.org/web/dibi.htm dibi]] [[http://amohseni.info/img/styles/porsche-/ porsche 996 4s nero]] [[http://helmed.info/topic/appartamento-vacanza/ appartamento vacanza ferrara]] [[http://helmed.info/topic/panasonic-hz/ panasonic 100hz]] [[http://chaba.info/vasco-rossi/ vasco rossi copertine]] [[http://bloprofeldi.info/lib/disegni-di.htm disegni di dei]] [[http://nobinters.org/creative-zen.htm creative zen micro 6gb bianco]] [[http://chaba.info/cartoline-net/ cartoline net]] [[http://davte.info/library/html/waddenzee.htm waddenzee]] [[http://bloprofeldi.info/lib/seat-arosa.htm seat arosa 1998]] [[http://bloprofeldi.info/lib/smashing.htm smashing]] [[http://davte.info/library/html/caterina-sylos.htm caterina sylos labini]] [[http://helmed.info/topic/calcio-lotto/ calcio lotto]] [[http://kinunia.cn/abit-ai.htm abit ai7]] [[http://nobinters.org/jak-e.htm jak e daxter ps2]] [[http://davte.info/library/html/diddlemania.htm diddlemania]] [[http://ustall.org/web/ricevitore-stereo.htm ricevitore stereo bluetooth]] [[http://ustall.org/web/navigatore-satellitare.htm navigatore satellitare palmare tomtom]] [[http://ustall.org/web/nelson-tavarez.htm nelson tavarez]] [[http://nobinters.org/tvc-lcd.htm tvc lcd 17]] [[http://nobinters.org/xdpicture-card.htm xd-picture card 512mb]] [[http://chaba.info/qualcosa-che/ qualcosa che scotta]] [[http://helmed.info/topic/dinh-ding/ dinh ding dong]] [[http://kinunia.cn/nx-pro.htm nx pro]] [[http://nobinters.org/nuove-immagini.htm nuove immagini da tekken 5]] [[http://chaba.info/isola-d/ isola d elba camping]] [[http://chaba.info/stampanti-laser/ stampanti laser canon]] [[http://saibso.org/lga-socket.htm lga775 socket]] [[http://psisemiya.com/images/small/inserzion/ inserzion]] [[http://davte.info/library/html/sennheiser-hd.htm sennheiser hd 212]] [[http://ustall.org/web/stampante-brother.htm stampante brother multifunzione mfc]] [[http://saibso.org/britney-vs.htm britney vs bob]] [[http://kinunia.cn/nikon-speedlight.htm nikon speedlight sb-800]] [[http://psisemiya.com/images/small/fighe-delle/ fighe delle persone famose]] [[http://amohseni.info/img/styles/ingravida/ ingravida]] [[http://bloprofeldi.info/lib/walthamstow.htm walthamstow]] [[http://amohseni.info/img/styles/offerta-hotel/ offerta hotel chicago]] [[http://nobinters.org/trust-bluetooth.htm trust bluetooth mini mouse]] [[http://chaba.info/o-quatrilho/ o quatrilho]] [[http://amohseni.info/img/styles/baso/ baso-]] [[http://helmed.info/topic/buoni-o/ buoni o cattivi remix]] [[http://saibso.org/maturita-.htm maturita 2004 italiano svolti]] [[http://helmed.info/topic/macchine-per/ macchine per microfusione]] [[http://ashythro.info/library/html/roman-polanski/ roman polanski box set]] [[http://saibso.org/voice.htm voice]] [[http://nobinters.org/capitan-harlock.htm capitan harlock. box set]] [[http://helmed.info/topic/auto-tvdvd/ auto tv-dvd]] [[http://saibso.org/hir-aj.htm hir aj cam hir ai go]] [[http://ashythro.info/library/html/zinco-ossido/ zinco ossido]] [[http://ustall.org/web/ivan-segreti.htm ivan segreti]] [[http://nobinters.org/luca-barbareschi.htm luca barbareschi]] [[http://nobinters.org/puglia-it.htm puglia it]] [[http://bloprofeldi.info/lib/sluchaczy.htm sluchaczy]] [[http://kinunia.cn/she-drives.htm she drives me crazy]] [[http://bloprofeldi.info/lib/pico-telecom.htm pico telecom]] [[http://nobinters.org/a.htm a75]] [[http://ustall.org/web/la-figlia.htm la figlia della madonna]] [[http://amohseni.info/img/styles/mensajes-movistar/ mensajes movistar]] [[http://saibso.org/vallata.htm vallata]] [[http://helmed.info/topic/dosminutos/ dosminutos]] [[http://psisemiya.com/images/small/cmt-a/ cmt a50]] [[http://chaba.info/terratec-cinergy/ terratec cinergy 2]] [[http://ustall.org/web/max-pane.htm max pane]] [[http://bloprofeldi.info/lib/occhiali-da.htm occhiali da sole byblos]] [[http://kinunia.cn/trasmettitore-segnale.htm trasmettitore segnale telecomando]] [[http://bloprofeldi.info/lib/http-tunnel.htm http tunnel crack]] [[http://bloprofeldi.info/lib/charlize.htm charlize]] [[http://kinunia.cn/buon-compleanno.htm buon compleanno biglietto d augurio]] [[http://amohseni.info/img/styles/abito-di/ abito di carnevale]] [[http://nobinters.org/eu-fico.htm eu fico]] [[http://psisemiya.com/images/small/dir-en/ dir en grey]] [[http://kinunia.cn/philips-mini.htm philips mini hi fi]] [[http://chaba.info/verifiche-impianti/ verifiche impianti termici bari]] [[http://bloprofeldi.info/lib/bow-wow.htm bow wow ft jojo]] == Fast Charger ==
Pinout :
* 1   5 volts @ 1,250 ma
* 2 Short to pin 3
* 3 short to pin 2
* 4 440kohm pulldown
* 5 GND

== Just Power on the phone ==

Pinout :
* 1 + 5 volts
* 2 NC
* 3 NC
* 4 440kohm pulldown
* 5 GND

== Headset Mode ==

Pinout :
* 1 The phone suppiles a voltage to the headset through this pin
* 2 Left Out for Stereo Playback  or Mono Out  for handsfree 
* 3 Right Out for Stereo Playback or Mono In (mix for handsfree) 
* 4 102Kohm pulldown
* 5 GND

Depending on what you do (play mp3 / calling) the phone will either switch to stereo mode or handsfree mode.
The pins are either routed to the Stereo DAC of PCAP or to a Mono DAC and a Mono ACD in PCAP.

== Factory Test & Flash ==

There apears to be a way to force the phone to power-on even when there is NO battery present by applying an unknown voltage on pin 4. It is apparently used during manufacturing of the phones and might therefore be detected somehow by the bootloader. The only difference to USB accesory mode is that the phone powers on even without battery, and that the voltage on pin4 is different. Nothing is known about voltage / resistor to be used. On the other hand this is not an interesting mode anyway.

[[Category:Hardware]]
