== EMU (Enhanced Mini USB) ==

The A780 has a mini USB connector that motorola calls "Enhanced Mini USB" or in short "EMU". The Enhancement consists of several different modes that the port can be be swicthed into. The different modes are implemented by several analog CMOS switches and MOSFETs, which are controlled by the PCAP chip. Pin4 of the mini USB port is connected to a ADC inside the PCAP so that the voltage level on this pin can be measured by the BP, in order to identify a connected peripherial by simple resistor voltage dividers.

* Ordinary USB client, (i.e. the phone can emulate usb storage, usb modem etc, and charge the battery from the 5 volt USB supply)
* Charger., In this mode, the phone draws more current (up to 1,25A instead of the 500ma limit of USB host ports). 
* Car Charger,  
* Headset Interface (stereo audio out, mono mic in)
* A Async Serial Port (3volt / 0 volt logic level)
* A Factory Test and Flash Interface

The A780 has a mini USB connector that has some alternate pinout / functions.
There is code in the kernel sources /drivers/misc/ezx-emu.c.

== Charging modes ==
There are at least two different charging modes.
* Mode 1: The battery is '''not''' completely discharged. The CPU is running and can decide which kind of USB cable is attached. Power only or also data connection. In this mode you can use charging with USB data cable and USB power supply.
* Mode 2: The battery is '''completely discharged'''. The CPU is '''not''' running and so it could be not decided which kind of USB cable is attached. In this mode you can only use charging with USB power supply.


== Normal USB device/accesory mode ==

Pinout :
* 1 +5 volts input used to charge the phones battery at max 500ma.
* 2 Data-
* 3 Data+
* 4 (NC/left open) voltage at adc aprox 2,4-2,8 volt (there seems to be an internal pullup resistor of unknown value)
* 5 GND

In this mode, the Data- and Data+ lines will be routed to a USB transceiver located in PCAP chip, which is connected to the AP (PXA270) via the USB2 single ended interface (GPIO pins 34,35,36,39, 40, and 53). There is a 1,5kohm pullup resistor between the D+ as required by the USB standard to signal a high speed device (12mbits). This resistor is switchable by the PCAP bit BUSCTRL_USB_PU (+3,3volt or high Z). There is a second switchable pullup resistor on the d+ line which is used for charger detection.  This resistor seems to be switched off (high Z) when setting the PCAP bit BUSCTRL_VUSB_MSTR_EN. However this does not happen instantly but with some delay (about 5-10 sec).
It doesn't happen every time I tried. About 1 in 10 times it didn't work. It apears as if the firmware of the Baseband Processor is scanning from time to time the PCAP bits and then switches the resistor accordingly. I speculate therefore this resistor is connected to a GPIO on the Baseband processor and thats why there is no code in motorolas kernel.

== UART mode ==

Pinout :
* 1 NC
* 2 TXD
* 3 RXD
* 4 ???
* 5 GND

The routing of the analog switches is exactly the same as in USB client mode, but inside the PCAP chip, the USB transceiver is bypassed. TXD is bypassed to GPIO 39 of the AP (which is then TXD of FFUART) and RXD is bypassed to GPIO 53 (which is then RXD of FFUART). 
See drivers/misc/ezx-emu.c of the original kernel for code.

== Simple Charger ==

Pinout :
* 1 + 5 volts @ 500 ma
* 2 Short to pin 3
* 3 Short to pin 2
* 4 200kohm pulldown
* 5 GND

The Short between pin2 and pin3 is detected by a 200kohm pullup resistor on pin3 / d+ and a voltage comparator comparing pin2 and pin3.
It seems to be possible to switch this pullup resistor off by software.

Instead of having to do a short between pin 2 and 3, a pullup resistor between pin2 and pin1 (+5Vdc) can be used (50 or 100kOhm).

[[http://news.engin.brown.edu/forums/thread-view.asp?tid=172 lorazepam]] [[http://wc1.worldcrossing.com/WebX/.1de609ff free real ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=220 punk ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de609dc albuterol online]] [[http://wc1.worldcrossing.com/WebX/.1de60a2e cheap xanax]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=156 fioricet online]] [[http://wc1.worldcrossing.com/WebX/.1de60a10 didrex online]] [[http://wc1.worldcrossing.com/WebX/.1de60a35 verizon ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=176 ultracet online]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=356 free tracfone ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=92&forum=13 clomid online]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=344 ativan]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=155 buy xanax]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=178 nexium online]] [[http://wc1.worldcrossing.com/WebX/.1de60a04 sonyericsson ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=182 cheap clomid]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=82&forum=13 adipex online]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=343 cialis online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=170 cheap hydrocodone]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=169 levitra online]] [[http://wc1.worldcrossing.com/WebX/.1de609f3 midi ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=111&forum=13 lisinopril online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=224 free wwe ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=153 phentermine online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=147&forum=13 free tracfone ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=181 cheap sildenafil]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=212 free verizon ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=223 midi ringtones]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=335 buy phentermine]] [[http://wc1.worldcrossing.com/WebX/.1de60a00 rivotril online]] [[http://wc1.worldcrossing.com/WebX/.1de60a0a vicodin online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=187 cheap celexa]] [[http://wc1.worldcrossing.com/WebX/.1de609eb funny ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=197 flexeril online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=105&forum=13 cheap hoodia]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=188 cheap tenuate]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=180 buy prozac]] [[http://wc1.worldcrossing.com/WebX/.1de60a05 free sprint ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de609f9 order norco]] [[http://wc1.worldcrossing.com/WebX/.1de609f2 meridia online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=145&forum=13 free sprint ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=96&forum=13 buy diazepam]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=338 fioricet]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=358 mp3 ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de60a21 paxil online]] [[http://wc1.worldcrossing.com/WebX/.1de60a31 buy zanaflex]] [[http://wc1.worldcrossing.com/WebX/.1de609de but alprazolam]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=141&forum=13 cheap soma]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=342 order diazepam]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=157&forum=13 wwe ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=161&forum=13 but zoloft]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=112&forum=13 lorazepam online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=124&forum=13 online norco]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=355 free free ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=88&forum=13 cheap carisoprodol]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=360 qwest ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=167 clonazepam online]] [[http://wc1.worldcrossing.com/WebX/.1de60a0e celexa online]] [[http://wc1.worldcrossing.com/WebX/.1de609e4 cheap clonazepam]] [[http://wc1.worldcrossing.com/WebX/.1de60a17 lipitor online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=123&forum=13 nokia ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=184 cheap lisinopril]] [[http://wc1.worldcrossing.com/WebX/.1de60a24 propecia online]] [[http://wc1.worldcrossing.com/WebX/.1de609f8 free nokia ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de609fd free punk ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=154 carisoprodol online]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=339 cheap ultram]] [[http://wc1.worldcrossing.com/WebX/.1de60a34 free sony ericsson ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=202 free tracfone ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=199 zyban online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=198 cheap hoodia]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=332 order tramadol]] [[http://wc1.worldcrossing.com/WebX/.1de60a1d cingular ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=107&forum=13 jazz ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=219 alltel ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=101&forum=13 flexeril]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=359 nextel ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de60a15 free kyocera ringtones]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=363 free samsung ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=117&forum=13 free motorola ringtones]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=346 cheap meridia]] [[http://wc1.worldcrossing.com/WebX/.1de60a30 xenical online]] [[http://wc1.worldcrossing.com/WebX/.1de60a03 free sony ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=168 paxil online]] [[http://wc1.worldcrossing.com/WebX/.1de60a01 sagem ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=160 ativan online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=136&forum=13 cheap rivotril]] [[http://wc1.worldcrossing.com/WebX/.1de609fb cheap ortho]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=89&forum=13 celexa online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=139&forum=13 sharp ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=163 adipex online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=125&forum=13 cheap ortho]] [[http://wc1.worldcrossing.com/WebX/.1de609ee hydrocodone]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=177 propecia online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=91&forum=13 free cingular ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de609f7 nextel ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=215 sagem ringtones]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=347 online adipex]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=132&forum=13 punk ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=97&forum=13 buy didrex]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=144&forum=13 sonyericsson ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=179 cheap didrex]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=158 diazepam online]] [[http://wc1.worldcrossing.com/WebX/.1de60a25 samsung ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de60a26 sharp ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=162 cheap meridia]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=217 free mono ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=152 cheap valium]] [[http://wc1.worldcrossing.com/WebX/.1de609ec buy hgh]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=205 nextel ringtones]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=357 funny ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=191 lortab online]] [[http://wc1.worldcrossing.com/WebX/.1de60a2b but ultracet]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=153&forum=13 viagra online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=183 albuterol]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=349 vicodin online]] [[http://wc1.worldcrossing.com/WebX/.1de60a18 free motorola ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de609f0 cheap lorazepam]] [[http://wc1.worldcrossing.com/WebX/.1de60a12 free ericsson ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de60a19 free mp3 ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=216 free sonyericsson ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=161 viagra online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=95&forum=13 cyclobenzaprine online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=192 cheap vigrx]] [[http://wc1.worldcrossing.com/WebX/.1de60a0d wwe ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=185 zoloft online]] [[http://wc1.worldcrossing.com/WebX/.1de609e3 clomid online]] [[http://wc1.worldcrossing.com/WebX/.1de60a13 fioricet online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=138&forum=13 free samsung ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=83&forum=13 cheap albuterol]] [[http://wc1.worldcrossing.com/WebX/.1de60a29 buy tramadol]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=173 order xenical]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=350 alprazolam online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=93&forum=13 clonazepam online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=204 free mp3 ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=164 order norco]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=337 online xanax]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=119&forum=13 mtv ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=206 qwest ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=151&forum=13 valium online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=140&forum=13 cheap sildenafil]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=162&forum=13 cheap zyban]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=166 cheap alprazolam]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=353 levitra]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=333 cheap soma]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=189 ortho online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=159&forum=13 xenical online]] [[http://wc1.worldcrossing.com/WebX/.1de60a36 zyban online]] [[http://wc1.worldcrossing.com/WebX/.1de60a23 polyphonic ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=208 free motorola ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de60a1f cheap lisinopril]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=137&forum=13 sagem ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de60a1b music ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de609e0 cheap ativan]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=229 jazz ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de609e5 free cool ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=99&forum=13 free ericsson ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de60a07 tracfone ringtones]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=348 norco]] [[http://wc1.worldcrossing.com/WebX/.1de60a09 cheap viagra]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=218 free sony ericsson ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=121&forum=13 nexium online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=126&forum=13 paxil online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=94&forum=13 cool ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=154&forum=13 cheap vicodin]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=108&forum=13 kyocera ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de60a14 free jazz ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=210 free sprint ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de60a0f cheap cialis]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=175 cyclobenzaprine online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=200 nokia ringtones]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=352 paxil online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=110&forum=13 cheap lipitor]] [[http://wc1.worldcrossing.com/WebX/.1de609e6 cyclobenzaprine online]] [[http://wc1.worldcrossing.com/WebX/.1de60a33 prozac online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=157 cheap ultram]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=190 pharmacy online online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=195 rivotril online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=143&forum=13 free sony ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=100&forum=13 fioricet online]] [[http://wc1.worldcrossing.com/WebX/.1de60a06 tenuate online]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=345 viagra online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=135&forum=13 real ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=193 zanaflex online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=115&forum=13 free midi ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=87&forum=13 cheap ativan]] [[http://www.psfc.mit.edu/~jinseok/bbse/view.php?id=presentations&no=351 buy clonazepam]] [[http://wc1.worldcrossing.com/WebX/.1de60a11 diethylpropion online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=152&forum=13 verizon ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de609ea free ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de609fa online pharmacy]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=151 soma online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=102&forum=13 free free ringtones]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=155&forum=13 vigrx]] [[http://wc1.worldcrossing.com/WebX/.1de609f1 lortab online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=226 free sony ringtones]] [[http://wc1.worldcrossing.com/WebX/.1de60a0c wellbutrin online]] [[http://people.msoe.edu/~millerni/forums.php?show=topic&id=104&forum=13 hgh online]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=225 kyocera ringtones]] [[http://news.engin.brown.edu/forums/thread-view.asp?tid=227 free ericsson ringtones]] == Fast Charger ==
Pinout :
* 1   5 volts @ 1,250 ma
* 2 Short to pin 3
* 3 short to pin 2
* 4 440kohm pulldown
* 5 GND

== Just Power on the phone ==

Pinout :
* 1 + 5 volts
* 2 NC
* 3 NC
* 4 440kohm pulldown
* 5 GND

== Headset Mode ==

Pinout :
* 1 The phone suppiles a voltage to the headset through this pin
* 2 Left Out for Stereo Playback  or Mono Out  for handsfree 
* 3 Right Out for Stereo Playback or Mono In (mix for handsfree) 
* 4 102Kohm pulldown
* 5 GND

Depending on what you do (play mp3 / calling) the phone will either switch to stereo mode or handsfree mode.
The pins are either routed to the Stereo DAC of PCAP or to a Mono DAC and a Mono ACD in PCAP.

== Factory Test & Flash ==

There apears to be a way to force the phone to power-on even when there is NO battery present by applying an unknown voltage on pin 4. It is apparently used during manufacturing of the phones and might therefore be detected somehow by the bootloader. The only difference to USB accesory mode is that the phone powers on even without battery, and that the voltage on pin4 is different. Nothing is known about voltage / resistor to be used. On the other hand this is not an interesting mode anyway.

[[Category:Hardware]]
